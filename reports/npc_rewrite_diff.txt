--- npc_203001.lua
+++ npc_203001_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1190].goal.getItem[1].id) >= qt[1190].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1190].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1191].goal.getItem[1].id) >= qt[1191].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1191].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1190].goal.getItem[1].id) >= qt[1190].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1190].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1191].goal.getItem[1].id) >= qt[1191].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1191].goal.getItem) then

--- npc_203006.lua
+++ npc_203006_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1198].goal.getItem[1].id) >= qt[1198].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1198].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[3704].goal.getItem[1].id) >= qt[3704].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3704].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1198].goal.getItem[1].id) >= qt[1198].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1198].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3704].goal.getItem[1].id) >= qt[3704].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3704].goal.getItem) then

--- npc_212001.lua
+++ npc_212001_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[110].goal.getItem[1].id) >= qt[110].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[110].goal.getItem) then
-   if qData[1240].state == 1 and CHECK_ITEM_CNT(qt[1240].goal.getItem[1].id) >= qt[1240].goal.getItem[1].count then
+   if qData[1240].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1240].goal.getItem) then
-   if qData[1250].state == 1 and CHECK_ITEM_CNT(qt[1250].goal.getItem[1].id) >= qt[1250].goal.getItem[1].count then
+   if qData[1250].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1250].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1251].goal.getItem[1].id) >= qt[1251].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1251].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[110].goal.getItem[1].id) >= qt[110].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[110].goal.getItem) then
-   if qData[1240].state == 1 and GET_PLAYER_LEVEL() >= qt[1240].needLevel and CHECK_ITEM_CNT(qt[1240].goal.getItem[1].id) >= qt[1240].goal.getItem[1].count then
+   if qData[1240].state == 1 and GET_PLAYER_LEVEL() >= qt[1240].needLevel and __QUEST_HAS_ALL_ITEMS(qt[1240].goal.getItem) then
-   if qData[1250].state == 1 and CHECK_ITEM_CNT(qt[1250].goal.getItem[1].id) >= qt[1250].goal.getItem[1].count then
+   if qData[1250].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1250].goal.getItem) then

--- npc_213001.lua
+++ npc_213001_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[84].goal.getItem[1].id) >= qt[84].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[84].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[122].goal.getItem[1].id) >= qt[122].goal.getItem[1].count and CHECK_ITEM_CNT(qt[122].goal.getItem[2].id) >= qt[122].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[122].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[127].goal.getItem[1].id) >= qt[127].goal.getItem[1].count and CHECK_ITEM_CNT(qt[127].goal.getItem[2].id) >= qt[127].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[127].goal.getItem) then
-   if qData[154].state == 1 and qData[154].meetNpc[1] ~= id and CHECK_ITEM_CNT(qt[154].goal.getItem[1].id) >= qt[154].goal.getItem[1].count then
+   if qData[154].state == 1 and qData[154].meetNpc[1] ~= id and __QUEST_HAS_ALL_ITEMS(qt[154].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[201].goal.getItem[1].id) >= qt[201].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[201].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[339].goal.getItem[1].id) >= qt[339].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[339].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[342].goal.getItem[1].id) >= qt[342].goal.getItem[1].count and CHECK_ITEM_CNT(qt[342].goal.getItem[2].id) >= qt[342].goal.getItem[2].count and CHECK_ITEM_CNT(qt[342].goal.getItem[3].id) >= qt[342].goal.getItem[3].count and CHECK_ITEM_CNT(qt[342].goal.getItem[4].id) >= qt[342].goal.getItem[4].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[342].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[348].goal.getItem[1].id) >= qt[348].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[348].goal.getItem) then
-   if qData[548].state == 1 and CHECK_ITEM_CNT(qt[548].goal.getItem[1].id) >= qt[548].goal.getItem[1].count and CHECK_ITEM_CNT(qt[548].goal.getItem[2].id) >= qt[548].goal.getItem[2].count then
+   if qData[548].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[548].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[549].goal.getItem[1].id) >= qt[549].goal.getItem[1].count and CHECK_ITEM_CNT(qt[549].goal.getItem[2].id) >= qt[549].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[549].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[122].goal.getItem[1].id) >= qt[122].goal.getItem[1].count and CHECK_ITEM_CNT(qt[122].goal.getItem[2].id) >= qt[122].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[122].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[127].goal.getItem[1].id) >= qt[127].goal.getItem[1].count and CHECK_ITEM_CNT(qt[127].goal.getItem[2].id) >= qt[127].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[127].goal.getItem) then

--- npc_213002.lua
+++ npc_213002_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[93].goal.getItem[1].id) >= qt[93].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[93].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[450].goal.getItem[1].id) >= qt[450].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[450].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1086].goal.getItem[1].id) >= qt[1086].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1086].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1094].goal.getItem[1].id) >= qt[1094].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1094].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1218].goal.getItem[1].id) >= qt[1218].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1218].goal.getItem) then
-   if qData[1218].state == 1 and CHECK_ITEM_CNT(qt[1218].goal.getItem[1].id) >= qt[1218].goal.getItem[1].count then
+   if qData[1218].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1218].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[93].goal.getItem[1].id) >= qt[93].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[93].goal.getItem) then
-     if qData[450].meetNpc[1] == qt[450].goal.meetNpc[1] and CHECK_ITEM_CNT(qt[450].goal.getItem[1].id) >= qt[450].goal.getItem[1].count then
+     if qData[450].meetNpc[1] == qt[450].goal.meetNpc[1] and __QUEST_HAS_ALL_ITEMS(qt[450].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1086].goal.getItem[1].id) >= qt[1086].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1086].goal.getItem) then

--- npc_213003.lua
+++ npc_213003_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-   if qData[340].state == 1 and CHECK_ITEM_CNT(qt[340].goal.getItem[1].id) >= qt[340].goal.getItem[1].count then
+   if qData[340].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[340].goal.getItem) then
-   if qData[343].state == 1 and CHECK_ITEM_CNT(qt[343].goal.getItem[1].id) >= qt[343].goal.getItem[1].count then
+   if qData[343].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[343].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1224].goal.getItem[1].id) >= qt[1224].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1224].goal.getItem) then
-   if qData[1237].state == 1 and CHECK_ITEM_CNT(qt[1237].goal.getItem[1].id) >= qt[1237].goal.getItem[1].count then
+   if qData[1237].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1237].goal.getItem) then
-   if qData[1224].state == 1 and CHECK_ITEM_CNT(qt[1224].goal.getItem[1].id) >= qt[1224].goal.getItem[1].count then
+   if qData[1224].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1224].goal.getItem) then
-   if qData[1237].state == 1 and CHECK_ITEM_CNT(qt[1237].goal.getItem[1].id) >= qt[1237].goal.getItem[1].count then
+   if qData[1237].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1237].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[340].goal.getItem[1].id) >= qt[340].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[340].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[343].goal.getItem[1].id) >= qt[343].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[343].goal.getItem) then

--- npc_213004.lua
+++ npc_213004_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[441].goal.getItem[1].id) >= qt[441].goal.getItem[1].count and CHECK_ITEM_CNT(qt[441].goal.getItem[2].id) >= qt[441].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[441].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[197].goal.getItem[1].id) >= qt[197].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[197].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[554].goal.getItem[1].id) >= qt[554].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[554].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[441].goal.getItem[1].id) >= qt[441].goal.getItem[1].count and CHECK_ITEM_CNT(qt[441].goal.getItem[2].id) >= qt[441].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[441].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[197].goal.getItem[1].id) >= qt[197].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[197].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[554].goal.getItem[1].id) >= qt[554].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[554].goal.getItem) then

--- npc_213005.lua
+++ npc_213005_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[83].goal.getItem[1].id) >= qt[83].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[83].goal.getItem) then
-   if qData[129].state == 1 and CHECK_ITEM_CNT(qt[129].goal.getItem[1].id) >= qt[129].goal.getItem[1].count and CHECK_ITEM_CNT(qt[129].goal.getItem[2].id) >= qt[129].goal.getItem[2].count then
+   if qData[129].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[129].goal.getItem) then
-   if qData[1188].state == 1 and CHECK_ITEM_CNT(qt[1188].goal.getItem[1].id) >= qt[1188].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1188].goal.getItem[2].id) >= qt[1188].goal.getItem[2].count then
+   if qData[1188].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1188].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[83].goal.getItem[1].id) >= qt[83].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[83].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[129].goal.getItem[1].id) >= qt[129].goal.getItem[1].count and CHECK_ITEM_CNT(qt[129].goal.getItem[2].id) >= qt[129].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[129].goal.getItem) then
-   if qData[1188].state ~= 2 and qData[1188].state == 1 and CHECK_ITEM_CNT(qt[1188].goal.getItem[1].id) >= qt[1188].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1188].goal.getItem[2].id) >= qt[1188].goal.getItem[2].count then
+   if qData[1188].state ~= 2 and qData[1188].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1188].goal.getItem) then

--- npc_213006.lua
+++ npc_213006_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     elseif CHECK_ITEM_CNT(qt[132].goal.getItem[1].id) >= qt[132].goal.getItem[1].count and CHECK_ITEM_CNT(qt[132].goal.getItem[2].id) >= qt[132].goal.getItem[2].count and CHECK_ITEM_CNT(qt[132].goal.getItem[3].id) >= qt[132].goal.getItem[3].count then
+     elseif __QUEST_HAS_ALL_ITEMS(qt[132].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[429].goal.getItem[1].id) >= qt[429].goal.getItem[1].count and CHECK_ITEM_CNT(qt[429].goal.getItem[2].id) >= qt[429].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[429].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[430].goal.getItem[1].id) >= qt[430].goal.getItem[1].count and CHECK_ITEM_CNT(qt[430].goal.getItem[2].id) >= qt[430].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[430].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[431].goal.getItem[1].id) >= qt[431].goal.getItem[1].count and CHECK_ITEM_CNT(qt[431].goal.getItem[2].id) >= qt[431].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[431].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[432].goal.getItem[1].id) >= qt[432].goal.getItem[1].count and CHECK_ITEM_CNT(qt[432].goal.getItem[2].id) >= qt[432].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[432].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[687].goal.getItem[1].id) >= qt[687].goal.getItem[1].count and CHECK_ITEM_CNT(qt[687].goal.getItem[2].id) >= qt[687].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[687].goal.getItem) then
-   if qData[437].state == 1 and CHECK_ITEM_CNT(qt[437].goal.getItem[1].id) >= qt[437].goal.getItem[1].count then
+   if qData[437].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[437].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[447].goal.getItem[1].id) >= qt[447].goal.getItem[1].count and CHECK_ITEM_CNT(qt[447].goal.getItem[2].id) >= qt[447].goal.getItem[2].count and CHECK_ITEM_CNT(qt[447].goal.getItem[3].id) >= qt[447].goal.getItem[3].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[447].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1151].goal.getItem[1].id) >= qt[1151].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1151].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1185].goal.getItem[1].id) >= qt[1185].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1185].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1186].goal.getItem[1].id) >= qt[1186].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1186].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1151].goal.getItem[1].id) >= qt[1151].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1151].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1185].goal.getItem[1].id) >= qt[1185].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1185].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1186].goal.getItem[1].id) >= qt[1186].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1186].goal.getItem) then

--- npc_213008.lua
+++ npc_213008_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[236].goal.getItem[1].id) >= qt[236].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[236].goal.getItem) then

--- npc_214001.lua
+++ npc_214001_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1113].goal.getItem[1].id) >= qt[1113].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1113].goal.getItem) then
-   if qData[1341].state == 1 and CHECK_ITEM_CNT(qt[1341].goal.getItem[1].id) >= qt[1341].goal.getItem[1].count then
+   if qData[1341].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1341].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1113].goal.getItem[1].id) >= qt[1113].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1113].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1341].goal.getItem[1].id) >= qt[1341].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1341].goal.getItem) then

--- npc_214002.lua
+++ npc_214002_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[861].goal.getItem[1].id) >= qt[861].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[861].goal.getItem) then

--- npc_214003.lua
+++ npc_214003_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1117].goal.getItem[1].id) >= qt[1117].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1117].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1117].goal.getItem[1].id) >= qt[1117].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1117].goal.getItem) then

--- npc_214004.lua
+++ npc_214004_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1085].goal.getItem[1].id) >= qt[1085].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1085].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1093].goal.getItem[1].id) >= qt[1093].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1093].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1118].goal.getItem[1].id) >= qt[1118].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1118].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1136].goal.getItem[1].id) >= qt[1136].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1136].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1085].goal.getItem[1].id) >= qt[1085].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1085].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1118].goal.getItem[1].id) >= qt[1118].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1118].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1136].goal.getItem[1].id) >= qt[1136].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1136].goal.getItem) then

--- npc_214005.lua
+++ npc_214005_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1181].goal.getItem[1].id) >= qt[1181].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1181].goal.getItem[2].id) >= qt[1181].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1181].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1181].goal.getItem[1].id) >= qt[1181].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1181].goal.getItem[2].id) >= qt[1181].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1181].goal.getItem) then

--- npc_214006.lua
+++ npc_214006_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1150].goal.getItem[1].id) >= qt[1150].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1150].goal.getItem) then
-   if qData[1183].state == 1 and CHECK_ITEM_CNT(qt[1183].goal.getItem[1].id) >= qt[1183].goal.getItem[1].count then
+   if qData[1183].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1183].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1184].goal.getItem[1].id) >= qt[1184].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1184].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1187].goal.getItem[1].id) >= qt[1187].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1187].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1150].goal.getItem[1].id) >= qt[1150].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1150].goal.getItem) then
-   if qData[1183].state ~= 2 and GET_PLAYER_LEVEL() >= qt[1183].needLevel and qData[1183].state == 1 and CHECK_ITEM_CNT(qt[1183].goal.getItem[1].id) >= qt[1183].goal.getItem[1].count then
+   if qData[1183].state ~= 2 and GET_PLAYER_LEVEL() >= qt[1183].needLevel and qData[1183].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1183].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1184].goal.getItem[1].id) >= qt[1184].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1184].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1187].goal.getItem[1].id) >= qt[1187].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1187].goal.getItem) then

--- npc_214010.lua
+++ npc_214010_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-   if qData[1101].state == 1 and CHECK_ITEM_CNT(qt[1101].goal.getItem[1].id) < qt[1101].goal.getItem[1].count then
+   if qData[1101].state == 1 and not __QUEST_HAS_ALL_ITEMS(qt[1101].goal.getItem) then

--- npc_215001.lua
+++ npc_215001_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[237].goal.getItem[1].id) >= qt[237].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[237].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1023].goal.getItem[1].id) >= qt[1023].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1023].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1024].goal.getItem[1].id) >= qt[1024].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1024].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1033].goal.getItem[1].id) >= qt[1033].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1033].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1034].goal.getItem[1].id) >= qt[1034].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1034].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1025].goal.getItem[1].id) >= qt[1025].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1025].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1026].goal.getItem[1].id) >= qt[1026].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1026].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1035].goal.getItem[1].id) >= qt[1035].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1035].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1036].goal.getItem[1].id) >= qt[1036].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1036].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1027].goal.getItem[1].id) >= qt[1027].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1027].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1028].goal.getItem[1].id) >= qt[1028].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1028].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1037].goal.getItem[1].id) >= qt[1037].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1037].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1038].goal.getItem[1].id) >= qt[1038].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1038].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1029].goal.getItem[1].id) >= qt[1029].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1029].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1030].goal.getItem[1].id) >= qt[1030].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1030].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1039].goal.getItem[1].id) >= qt[1039].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1039].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1040].goal.getItem[1].id) >= qt[1040].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1040].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1031].goal.getItem[1].id) >= qt[1031].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1031].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1032].goal.getItem[1].id) >= qt[1032].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1032].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1041].goal.getItem[1].id) >= qt[1041].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1041].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1042].goal.getItem[1].id) >= qt[1042].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1042].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1274].goal.getItem[1].id) >= qt[1274].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1274].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1282].goal.getItem[1].id) >= qt[1282].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1282].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1297].goal.getItem[1].id) >= qt[1297].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1297].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1298].goal.getItem[1].id) >= qt[1298].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1298].goal.getItem) then
-   if qData[1023].state == 0 and GET_PLAYER_JOB1() == 1 and CHECK_ITEM_CNT(qt[1023].goal.getItem[1].id) >= qt[1023].goal.getItem[1].count then
+   if qData[1023].state == 0 and GET_PLAYER_JOB1() == 1 and __QUEST_HAS_ALL_ITEMS(qt[1023].goal.getItem) then
-   if qData[1024].state == 0 and GET_PLAYER_JOB1() == 1 and CHECK_ITEM_CNT(qt[1024].goal.getItem[1].id) >= qt[1024].goal.getItem[1].count then
+   if qData[1024].state == 0 and GET_PLAYER_JOB1() == 1 and __QUEST_HAS_ALL_ITEMS(qt[1024].goal.getItem) then
-   if qData[1033].state == 0 and GET_PLAYER_JOB1() == 1 and CHECK_ITEM_CNT(qt[1033].goal.getItem[1].id) >= qt[1033].goal.getItem[1].count then
+   if qData[1033].state == 0 and GET_PLAYER_JOB1() == 1 and __QUEST_HAS_ALL_ITEMS(qt[1033].goal.getItem) then
-   if qData[1034].state == 0 and GET_PLAYER_JOB1() == 1 and CHECK_ITEM_CNT(qt[1034].goal.getItem[1].id) >= qt[1034].goal.getItem[1].count then
+   if qData[1034].state == 0 and GET_PLAYER_JOB1() == 1 and __QUEST_HAS_ALL_ITEMS(qt[1034].goal.getItem) then
-   if qData[1025].state == 0 and GET_PLAYER_JOB1() == 2 and CHECK_ITEM_CNT(qt[1025].goal.getItem[1].id) >= qt[1025].goal.getItem[1].count then
+   if qData[1025].state == 0 and GET_PLAYER_JOB1() == 2 and __QUEST_HAS_ALL_ITEMS(qt[1025].goal.getItem) then
-   if qData[1026].state == 0 and GET_PLAYER_JOB1() == 2 and CHECK_ITEM_CNT(qt[1026].goal.getItem[1].id) >= qt[1026].goal.getItem[1].count then
+   if qData[1026].state == 0 and GET_PLAYER_JOB1() == 2 and __QUEST_HAS_ALL_ITEMS(qt[1026].goal.getItem) then
-   if qData[1035].state == 0 and GET_PLAYER_JOB1() == 2 and CHECK_ITEM_CNT(qt[1035].goal.getItem[1].id) >= qt[1035].goal.getItem[1].count then
+   if qData[1035].state == 0 and GET_PLAYER_JOB1() == 2 and __QUEST_HAS_ALL_ITEMS(qt[1035].goal.getItem) then
-   if qData[1036].state == 0 and GET_PLAYER_JOB1() == 2 and CHECK_ITEM_CNT(qt[1036].goal.getItem[1].id) >= qt[1036].goal.getItem[1].count then
+   if qData[1036].state == 0 and GET_PLAYER_JOB1() == 2 and __QUEST_HAS_ALL_ITEMS(qt[1036].goal.getItem) then
-   if qData[1027].state == 0 and GET_PLAYER_JOB1() == 3 and CHECK_ITEM_CNT(qt[1027].goal.getItem[1].id) >= qt[1027].goal.getItem[1].count then
+   if qData[1027].state == 0 and GET_PLAYER_JOB1() == 3 and __QUEST_HAS_ALL_ITEMS(qt[1027].goal.getItem) then
-   if qData[1028].state == 0 and GET_PLAYER_JOB1() == 3 and CHECK_ITEM_CNT(qt[1028].goal.getItem[1].id) >= qt[1028].goal.getItem[1].count then
+   if qData[1028].state == 0 and GET_PLAYER_JOB1() == 3 and __QUEST_HAS_ALL_ITEMS(qt[1028].goal.getItem) then
-   if qData[1037].state == 0 and GET_PLAYER_JOB1() == 3 and CHECK_ITEM_CNT(qt[1037].goal.getItem[1].id) >= qt[1037].goal.getItem[1].count then
+   if qData[1037].state == 0 and GET_PLAYER_JOB1() == 3 and __QUEST_HAS_ALL_ITEMS(qt[1037].goal.getItem) then
-   if qData[1038].state == 0 and GET_PLAYER_JOB1() == 3 and CHECK_ITEM_CNT(qt[1038].goal.getItem[1].id) >= qt[1038].goal.getItem[1].count then
+   if qData[1038].state == 0 and GET_PLAYER_JOB1() == 3 and __QUEST_HAS_ALL_ITEMS(qt[1038].goal.getItem) then
-   if qData[1029].state == 0 and GET_PLAYER_JOB1() == 4 and CHECK_ITEM_CNT(qt[1029].goal.getItem[1].id) >= qt[1029].goal.getItem[1].count then
+   if qData[1029].state == 0 and GET_PLAYER_JOB1() == 4 and __QUEST_HAS_ALL_ITEMS(qt[1029].goal.getItem) then
-   if qData[1030].state == 0 and GET_PLAYER_JOB1() == 4 and CHECK_ITEM_CNT(qt[1030].goal.getItem[1].id) >= qt[1030].goal.getItem[1].count then
+   if qData[1030].state == 0 and GET_PLAYER_JOB1() == 4 and __QUEST_HAS_ALL_ITEMS(qt[1030].goal.getItem) then
-   if qData[1039].state == 0 and GET_PLAYER_JOB1() == 4 and CHECK_ITEM_CNT(qt[1039].goal.getItem[1].id) >= qt[1039].goal.getItem[1].count then
+   if qData[1039].state == 0 and GET_PLAYER_JOB1() == 4 and __QUEST_HAS_ALL_ITEMS(qt[1039].goal.getItem) then
-   if qData[1040].state == 0 and GET_PLAYER_JOB1() == 4 and CHECK_ITEM_CNT(qt[1040].goal.getItem[1].id) >= qt[1040].goal.getItem[1].count then
+   if qData[1040].state == 0 and GET_PLAYER_JOB1() == 4 and __QUEST_HAS_ALL_ITEMS(qt[1040].goal.getItem) then
-   if qData[1031].state == 0 and GET_PLAYER_JOB1() == 5 and CHECK_ITEM_CNT(qt[1031].goal.getItem[1].id) >= qt[1031].goal.getItem[1].count then
+   if qData[1031].state == 0 and GET_PLAYER_JOB1() == 5 and __QUEST_HAS_ALL_ITEMS(qt[1031].goal.getItem) then
-   if qData[1032].state == 0 and GET_PLAYER_JOB1() == 5 and CHECK_ITEM_CNT(qt[1032].goal.getItem[1].id) >= qt[1032].goal.getItem[1].count then
+   if qData[1032].state == 0 and GET_PLAYER_JOB1() == 5 and __QUEST_HAS_ALL_ITEMS(qt[1032].goal.getItem) then
-   if qData[1041].state == 0 and GET_PLAYER_JOB1() == 5 and CHECK_ITEM_CNT(qt[1041].goal.getItem[1].id) >= qt[1041].goal.getItem[1].count then
+   if qData[1041].state == 0 and GET_PLAYER_JOB1() == 5 and __QUEST_HAS_ALL_ITEMS(qt[1041].goal.getItem) then
-   if qData[1042].state == 0 and GET_PLAYER_JOB1() == 5 and CHECK_ITEM_CNT(qt[1042].goal.getItem[1].id) >= qt[1042].goal.getItem[1].count then
+   if qData[1042].state == 0 and GET_PLAYER_JOB1() == 5 and __QUEST_HAS_ALL_ITEMS(qt[1042].goal.getItem) then
-   if (qData[1023].state ~= 2 or qData[1024].state ~= 2 or qData[1033].state ~= 2 or qData[1034].state ~= 2) and GET_PLAYER_JOB1() == 1 and (CHECK_ITEM_CNT(qt[1023].goal.getItem[1].id) >= qt[1023].goal.getItem[1].count or CHECK_ITEM_CNT(qt[1024].goal.getItem[1].id) >= qt[1024].goal.getItem[1].count or CHECK_ITEM_CNT(qt[1033].goal.getItem[1].id) >= qt[1033].goal.getItem[1].count or CHECK_ITEM_CNT(qt[1034].goal.getItem[1].id) >= qt[1034].goal.getItem[1].count) then
+   if (qData[1023].state ~= 2 or qData[1024].state ~= 2 or qData[1033].state ~= 2 or qData[1034].state ~= 2) and GET_PLAYER_JOB1() == 1 and (__QUEST_HAS_ALL_ITEMS(qt[1023].goal.getItem) or __QUEST_HAS_ALL_ITEMS(qt[1024].goal.getItem) or __QUEST_HAS_ALL_ITEMS(qt[1033].goal.getItem) or __QUEST_HAS_ALL_ITEMS(qt[1034].goal.getItem)) then
-       if CHECK_ITEM_CNT(qt[1023].goal.getItem[1].id) >= qt[1023].goal.getItem[1].count or CHECK_ITEM_CNT(qt[1024].goal.getItem[1].id) >= qt[1024].goal.getItem[1].count or CHECK_ITEM_CNT(qt[1033].goal.getItem[1].id) >= qt[1033].goal.getItem[1].count or CHECK_ITEM_CNT(qt[1034].goal.getItem[1].id) >= qt[1034].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1023].goal.getItem) or __QUEST_HAS_ALL_ITEMS(qt[1024].goal.getItem) or __QUEST_HAS_ALL_ITEMS(qt[1033].goal.getItem) or __QUEST_HAS_ALL_ITEMS(qt[1034].goal.getItem) then
-   if (qData[1025].state ~= 2 or qData[1026].state ~= 2 or qData[1035].state ~= 2 or qData[1036].state ~= 2) and GET_PLAYER_JOB1() == 2 and (CHECK_ITEM_CNT(qt[1025].goal.getItem[1].id) >= qt[1025].goal.getItem[1].count or CHECK_ITEM_CNT(qt[1026].goal.getItem[1].id) >= qt[1026].goal.getItem[1].count or CHECK_ITEM_CNT(qt[1035].goal.getItem[1].id) >= qt[1035].goal.getItem[1].count or CHECK_ITEM_CNT(qt[1036].goal.getItem[1].id) >= qt[1036].goal.getItem[1].count) then
+   if (qData[1025].state ~= 2 or qData[1026].state ~= 2 or qData[1035].state ~= 2 or qData[1036].state ~= 2) and GET_PLAYER_JOB1() == 2 and (__QUEST_HAS_ALL_ITEMS(qt[1025].goal.getItem) or __QUEST_HAS_ALL_ITEMS(qt[1026].goal.getItem) or __QUEST_HAS_ALL_ITEMS(qt[1035].goal.getItem) or __QUEST_HAS_ALL_ITEMS(qt[1036].goal.getItem)) then
-       if CHECK_ITEM_CNT(qt[1025].goal.getItem[1].id) >= qt[1025].goal.getItem[1].count or CHECK_ITEM_CNT(qt[1026].goal.getItem[1].id) >= qt[1026].goal.getItem[1].count or CHECK_ITEM_CNT(qt[1035].goal.getItem[1].id) >= qt[1035].goal.getItem[1].count or CHECK_ITEM_CNT(qt[1036].goal.getItem[1].id) >= qt[1036].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1025].goal.getItem) or __QUEST_HAS_ALL_ITEMS(qt[1026].goal.getItem) or __QUEST_HAS_ALL_ITEMS(qt[1035].goal.getItem) or __QUEST_HAS_ALL_ITEMS(qt[1036].goal.getItem) then
-   if (qData[1027].state ~= 2 or qData[1028].state ~= 2 or qData[1037].state ~= 2 or qData[1038].state ~= 2) and GET_PLAYER_JOB1() == 3 and (CHECK_ITEM_CNT(qt[1027].goal.getItem[1].id) >= qt[1027].goal.getItem[1].count or CHECK_ITEM_CNT(qt[1028].goal.getItem[1].id) >= qt[1028].goal.getItem[1].count or CHECK_ITEM_CNT(qt[1037].goal.getItem[1].id) >= qt[1037].goal.getItem[1].count or CHECK_ITEM_CNT(qt[1038].goal.getItem[1].id) >= qt[1038].goal.getItem[1].count) then
+   if (qData[1027].state ~= 2 or qData[1028].state ~= 2 or qData[1037].state ~= 2 or qData[1038].state ~= 2) and GET_PLAYER_JOB1() == 3 and (__QUEST_HAS_ALL_ITEMS(qt[1027].goal.getItem) or __QUEST_HAS_ALL_ITEMS(qt[1028].goal.getItem) or __QUEST_HAS_ALL_ITEMS(qt[1037].goal.getItem) or __QUEST_HAS_ALL_ITEMS(qt[1038].goal.getItem)) then
-       if CHECK_ITEM_CNT(qt[1027].goal.getItem[1].id) >= qt[1027].goal.getItem[1].count or CHECK_ITEM_CNT(qt[1028].goal.getItem[1].id) >= qt[1028].goal.getItem[1].count or CHECK_ITEM_CNT(qt[1037].goal.getItem[1].id) >= qt[1037].goal.getItem[1].count or CHECK_ITEM_CNT(qt[1038].goal.getItem[1].id) >= qt[1038].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1027].goal.getItem) or __QUEST_HAS_ALL_ITEMS(qt[1028].goal.getItem) or __QUEST_HAS_ALL_ITEMS(qt[1037].goal.getItem) or __QUEST_HAS_ALL_ITEMS(qt[1038].goal.getItem) then
-   if (qData[1029].state ~= 2 or qData[1030].state ~= 2 or qData[1039].state ~= 2 or qData[1040].state ~= 2) and GET_PLAYER_JOB1() == 4 and (CHECK_ITEM_CNT(qt[1029].goal.getItem[1].id) >= qt[1029].goal.getItem[1].count or CHECK_ITEM_CNT(qt[1030].goal.getItem[1].id) >= qt[1030].goal.getItem[1].count or CHECK_ITEM_CNT(qt[1039].goal.getItem[1].id) >= qt[1039].goal.getItem[1].count or CHECK_ITEM_CNT(qt[1040].goal.getItem[1].id) >= qt[1040].goal.getItem[1].count) then
+   if (qData[1029].state ~= 2 or qData[1030].state ~= 2 or qData[1039].state ~= 2 or qData[1040].state ~= 2) and GET_PLAYER_JOB1() == 4 and (__QUEST_HAS_ALL_ITEMS(qt[1029].goal.getItem) or __QUEST_HAS_ALL_ITEMS(qt[1030].goal.getItem) or __QUEST_HAS_ALL_ITEMS(qt[1039].goal.getItem) or __QUEST_HAS_ALL_ITEMS(qt[1040].goal.getItem)) then
-       if CHECK_ITEM_CNT(qt[1029].goal.getItem[1].id) >= qt[1029].goal.getItem[1].count or CHECK_ITEM_CNT(qt[1030].goal.getItem[1].id) >= qt[1030].goal.getItem[1].count or CHECK_ITEM_CNT(qt[1039].goal.getItem[1].id) >= qt[1039].goal.getItem[1].count or CHECK_ITEM_CNT(qt[1040].goal.getItem[1].id) >= qt[1040].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1029].goal.getItem) or __QUEST_HAS_ALL_ITEMS(qt[1030].goal.getItem) or __QUEST_HAS_ALL_ITEMS(qt[1039].goal.getItem) or __QUEST_HAS_ALL_ITEMS(qt[1040].goal.getItem) then
-   if (qData[1031].state ~= 2 or qData[1032].state ~= 2 or qData[1041].state ~= 2 or qData[1042].state ~= 2) and GET_PLAYER_JOB1() == 5 and (CHECK_ITEM_CNT(qt[1031].goal.getItem[1].id) >= qt[1031].goal.getItem[1].count or CHECK_ITEM_CNT(qt[1032].goal.getItem[1].id) >= qt[1032].goal.getItem[1].count or CHECK_ITEM_CNT(qt[1041].goal.getItem[1].id) >= qt[1041].goal.getItem[1].count or CHECK_ITEM_CNT(qt[1042].goal.getItem[1].id) >= qt[1042].goal.getItem[1].count) then
+   if (qData[1031].state ~= 2 or qData[1032].state ~= 2 or qData[1041].state ~= 2 or qData[1042].state ~= 2) and GET_PLAYER_JOB1() == 5 and (__QUEST_HAS_ALL_ITEMS(qt[1031].goal.getItem) or __QUEST_HAS_ALL_ITEMS(qt[1032].goal.getItem) or __QUEST_HAS_ALL_ITEMS(qt[1041].goal.getItem) or __QUEST_HAS_ALL_ITEMS(qt[1042].goal.getItem)) then
-       if CHECK_ITEM_CNT(qt[1031].goal.getItem[1].id) >= qt[1031].goal.getItem[1].count or CHECK_ITEM_CNT(qt[1032].goal.getItem[1].id) >= qt[1032].goal.getItem[1].count or CHECK_ITEM_CNT(qt[1041].goal.getItem[1].id) >= qt[1041].goal.getItem[1].count or CHECK_ITEM_CNT(qt[1042].goal.getItem[1].id) >= qt[1042].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1031].goal.getItem) or __QUEST_HAS_ALL_ITEMS(qt[1032].goal.getItem) or __QUEST_HAS_ALL_ITEMS(qt[1041].goal.getItem) or __QUEST_HAS_ALL_ITEMS(qt[1042].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1274].goal.getItem[1].id) >= qt[1274].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1274].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1282].goal.getItem[1].id) >= qt[1282].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1282].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1297].goal.getItem[1].id) >= qt[1297].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1297].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1298].goal.getItem[1].id) >= qt[1298].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1298].goal.getItem) then

--- npc_215002.lua
+++ npc_215002_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[153].goal.getItem[1].id) >= qt[153].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[153].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1281].goal.getItem[1].id) >= qt[1281].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1281].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1095].goal.getItem[1].id) >= qt[1095].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1095].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1281].goal.getItem[1].id) >= qt[1281].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1281].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1087].goal.getItem[1].id) >= qt[1087].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1087].goal.getItem) then

--- npc_215003.lua
+++ npc_215003_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[152].goal.getItem[1].id) >= qt[152].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[152].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[165].goal.getItem[1].id) >= qt[165].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[165].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1273].goal.getItem[1].id) >= qt[1273].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1273].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1275].goal.getItem[1].id) >= qt[1275].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1275].goal.getItem[2].id) >= qt[1275].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1275].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1273].goal.getItem[1].id) >= qt[1273].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1273].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1275].goal.getItem[1].id) >= qt[1275].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1275].goal.getItem[2].id) >= qt[1275].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1275].goal.getItem) then

--- npc_215004.lua
+++ npc_215004_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[160].goal.getItem[1].id) >= qt[160].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[160].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[164].goal.getItem[1].id) >= qt[164].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[164].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[276].goal.getItem[1].id) >= qt[276].goal.getItem[1].count and CHECK_ITEM_CNT(qt[276].goal.getItem[2].id) >= qt[276].goal.getItem[2].count and CHECK_ITEM_CNT(qt[276].goal.getItem[3].id) >= qt[276].goal.getItem[3].count and CHECK_ITEM_CNT(qt[276].goal.getItem[4].id) >= qt[276].goal.getItem[4].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[276].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[451].goal.getItem[1].id) >= qt[451].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[451].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[556].goal.getItem[1].id) >= qt[556].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[556].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1283].goal.getItem[1].id) >= qt[1283].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1283].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1306].goal.getItem[1].id) >= qt[1306].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1306].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1307].goal.getItem[1].id) >= qt[1307].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1307].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1308].goal.getItem[1].id) >= qt[1308].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1308].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1309].goal.getItem[1].id) >= qt[1309].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1309].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1310].goal.getItem[1].id) >= qt[1310].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1310].goal.getItem[2].id) >= qt[1310].goal.getItem[2].count and CHECK_ITEM_CNT(qt[1310].goal.getItem[3].id) >= qt[1310].goal.getItem[3].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1310].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1311].goal.getItem[1].id) >= qt[1311].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1311].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1312].goal.getItem[1].id) >= qt[1312].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1312].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[276].goal.getItem[1].id) >= qt[276].goal.getItem[1].count and CHECK_ITEM_CNT(qt[276].goal.getItem[2].id) >= qt[276].goal.getItem[2].count and CHECK_ITEM_CNT(qt[276].goal.getItem[3].id) >= qt[276].goal.getItem[3].count and CHECK_ITEM_CNT(qt[276].goal.getItem[4].id) >= qt[276].goal.getItem[4].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[276].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1283].goal.getItem[1].id) >= qt[1283].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1283].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1306].goal.getItem[1].id) >= qt[1306].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1306].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1307].goal.getItem[1].id) >= qt[1307].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1307].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1308].goal.getItem[1].id) >= qt[1308].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1308].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1309].goal.getItem[1].id) >= qt[1309].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1309].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1310].goal.getItem[1].id) >= qt[1310].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1310].goal.getItem[2].id) >= qt[1310].goal.getItem[2].count and CHECK_ITEM_CNT(qt[1310].goal.getItem[3].id) >= qt[1310].goal.getItem[3].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1310].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1311].goal.getItem[1].id) >= qt[1311].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1311].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1312].goal.getItem[1].id) >= qt[1312].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1312].goal.getItem) then

--- npc_215005.lua
+++ npc_215005_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[234].goal.getItem[1].id) >= qt[234].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[234].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[544].goal.getItem[1].id) >= qt[544].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[544].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[545].goal.getItem[1].id) >= qt[545].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[545].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[557].goal.getItem[1].id) >= qt[557].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[557].goal.getItem) then
-     if qData[1070].killMonster[qt[1070].goal.killMonster[1].id] >= qt[1070].goal.killMonster[1].count and CHECK_ITEM_CNT(qt[1070].goal.getItem[1].id) >= qt[1070].goal.getItem[1].count then
+     if qData[1070].killMonster[qt[1070].goal.killMonster[1].id] >= qt[1070].goal.killMonster[1].count and __QUEST_HAS_ALL_ITEMS(qt[1070].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1284].goal.getItem[1].id) >= qt[1284].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1284].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1303].goal.getItem[1].id) >= qt[1303].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1303].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1304].goal.getItem[1].id) >= qt[1304].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1304].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1284].goal.getItem[1].id) >= qt[1284].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1284].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1303].goal.getItem[1].id) >= qt[1303].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1303].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1304].goal.getItem[1].id) >= qt[1304].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1304].goal.getItem) then

--- npc_216001.lua
+++ npc_216001_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1555].goal.getItem[1].id) >= qt[1555].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1555].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1550].goal.getItem[1].id) >= qt[1550].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1550].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1544].goal.getItem[1].id) >= qt[1544].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1544].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[293].goal.getItem[1].id) >= qt[293].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[293].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1555].goal.getItem[1].id) >= qt[1555].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1555].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1550].goal.getItem[1].id) >= qt[1550].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1550].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1544].goal.getItem[1].id) >= qt[1544].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1544].goal.getItem) then

--- npc_216002.lua
+++ npc_216002_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[289].goal.getItem[1].id) >= qt[289].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[289].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[291].goal.getItem[1].id) >= qt[291].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[291].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[291].goal.getItem[2].id) >= qt[291].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[291].goal.getItem) then

--- npc_216003.lua
+++ npc_216003_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[295].goal.getItem[1].id) >= qt[295].goal.getItem[1].count and CHECK_ITEM_CNT(qt[295].goal.getItem[2].id) >= qt[295].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[295].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[482].goal.getItem[1].id) >= qt[482].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[482].goal.getItem) then

--- npc_216006.lua
+++ npc_216006_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2125].goal.getItem[1].id) >= qt[2125].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2125].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2129].goal.getItem[1].id) >= qt[2129].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2129].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2125].goal.getItem[1].id) >= qt[2125].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2125].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2129].goal.getItem[1].id) >= qt[2129].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2129].goal.getItem) then

--- npc_216007.lua
+++ npc_216007_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[533].goal.getItem[1].id) >= qt[533].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[533].goal.getItem) then

--- npc_216008.lua
+++ npc_216008_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1011].goal.getItem[1].id) >= qt[1011].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1011].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2439].goal.getItem[1].id) >= qt[2439].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2439].goal.getItem[2].id) >= qt[2439].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2439].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2440].goal.getItem[1].id) >= qt[2440].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2440].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2441].goal.getItem[1].id) >= qt[2441].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2441].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2490].goal.getItem[1].id) >= qt[2490].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2490].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2491].goal.getItem[1].id) >= qt[2491].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2491].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2492].goal.getItem[1].id) >= qt[2492].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2492].goal.getItem[2].id) >= qt[2492].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2492].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2493].goal.getItem[1].id) >= qt[2493].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2493].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[3666].goal.getItem[1].id) >= qt[3666].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3666].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[3667].goal.getItem[1].id) >= qt[3667].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3667].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1011].goal.getItem[1].id) >= qt[1011].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1011].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3666].goal.getItem[1].id) >= qt[3666].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3666].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3667].goal.getItem[1].id) >= qt[3667].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3667].goal.getItem) then

--- npc_217001.lua
+++ npc_217001_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1159].goal.getItem[1].id) >= qt[1159].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1159].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1162].goal.getItem[1].id) >= qt[1162].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1162].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1159].goal.getItem[1].id) >= qt[1159].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1159].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1162].goal.getItem[1].id) >= qt[1162].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1162].goal.getItem) then

--- npc_217005.lua
+++ npc_217005_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if qData[347].killMonster[qt[347].goal.killMonster[1].id] >= qt[347].goal.killMonster[1].count and CHECK_ITEM_CNT(qt[347].goal.getItem[1].id) >= qt[347].goal.getItem[1].count then
+     if qData[347].killMonster[qt[347].goal.killMonster[1].id] >= qt[347].goal.killMonster[1].count and __QUEST_HAS_ALL_ITEMS(qt[347].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1156].goal.getItem[1].id) >= qt[1156].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1156].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1163].goal.getItem[1].id) >= qt[1163].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1163].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1156].goal.getItem[1].id) >= qt[1156].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1156].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1163].goal.getItem[1].id) >= qt[1163].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1163].goal.getItem) then

--- npc_218006.lua
+++ npc_218006_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1397].goal.getItem[1].id) >= qt[1397].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1397].goal.getItem) then

--- npc_218007.lua
+++ npc_218007_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[576].goal.getItem[1].id) >= qt[576].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[576].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[576].goal.getItem[1].id) >= qt[576].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[576].goal.getItem) then

--- npc_218008.lua
+++ npc_218008_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1459].goal.getItem[1].id) >= qt[1459].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1459].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1459].goal.getItem[1].id) >= qt[1459].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1459].goal.getItem) then

--- npc_220001.lua
+++ npc_220001_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1013].goal.getItem[1].id) >= qt[1013].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1013].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1014].goal.getItem[1].id) >= qt[1014].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1014].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2469].goal.getItem[1].id) >= qt[2469].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2469].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1013].goal.getItem[1].id) >= qt[1013].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1013].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1014].goal.getItem[1].id) >= qt[1014].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1014].goal.getItem) then

--- npc_221011.lua
+++ npc_221011_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[3658].goal.getItem[1].id) >= qt[3658].goal.getItem[1].count and CHECK_ITEM_CNT(qt[3658].goal.getItem[2].id) >= qt[3658].goal.getItem[2].count and CHECK_ITEM_CNT(qt[3658].goal.getItem[3].id) >= qt[3658].goal.getItem[3].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3658].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3658].goal.getItem[1].id) >= qt[3658].goal.getItem[1].count and CHECK_ITEM_CNT(qt[3658].goal.getItem[2].id) >= qt[3658].goal.getItem[2].count and CHECK_ITEM_CNT(qt[3658].goal.getItem[3].id) >= qt[3658].goal.getItem[3].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3658].goal.getItem) then

--- npc_222001.lua
+++ npc_222001_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2329].goal.getItem[1].id) >= qt[2329].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2329].goal.getItem[2].id) >= qt[2329].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2329].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2663].goal.getItem[1].id) >= qt[2663].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2663].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2664].goal.getItem[1].id) >= qt[2664].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2664].goal.getItem) then
-   if qData[2667].state == 1 and CHECK_ITEM_CNT(qt[2667].goal.getItem[1].id) >= qt[2667].goal.getItem[1].count then
+   if qData[2667].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[2667].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2678].goal.getItem[1].id) >= qt[2678].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2678].goal.getItem) then
-   if qData[2738].state == 1 and CHECK_ITEM_CNT(qt[2738].goal.getItem[1].id) >= qt[2738].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2738].goal.getItem[2].id) >= qt[2738].goal.getItem[2].count then
+   if qData[2738].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[2738].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2803].goal.getItem[1].id) >= qt[2803].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2803].goal.getItem[2].id) >= qt[2803].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2803].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2804].goal.getItem[1].id) >= qt[2804].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2804].goal.getItem[2].id) >= qt[2804].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2804].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2805].goal.getItem[1].id) >= qt[2805].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2805].goal.getItem[2].id) >= qt[2805].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2805].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[3742].goal.getItem[1].id) >= qt[3742].goal.getItem[1].count and CHECK_ITEM_CNT(qt[3742].goal.getItem[2].id) >= qt[3742].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3742].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2329].goal.getItem[1].id) >= qt[2329].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2329].goal.getItem[2].id) >= qt[2329].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2329].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2663].goal.getItem[1].id) >= qt[2663].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2663].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2664].goal.getItem[1].id) >= qt[2664].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2664].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2667].goal.getItem[1].id) >= qt[2667].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2667].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2678].goal.getItem[1].id) >= qt[2678].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2678].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2738].goal.getItem[1].id) >= qt[2738].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2738].goal.getItem[2].id) >= qt[2738].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2738].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2803].goal.getItem[1].id) >= qt[2803].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2803].goal.getItem[2].id) >= qt[2803].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2803].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2804].goal.getItem[1].id) >= qt[2804].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2804].goal.getItem[2].id) >= qt[2804].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2804].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2805].goal.getItem[1].id) >= qt[2805].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2805].goal.getItem[2].id) >= qt[2805].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2805].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3742].goal.getItem[1].id) >= qt[3742].goal.getItem[1].count and CHECK_ITEM_CNT(qt[3742].goal.getItem[2].id) >= qt[3742].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3742].goal.getItem) then

--- npc_222002.lua
+++ npc_222002_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1049].goal.getItem[1].id) >= qt[1049].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1049].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1056].goal.getItem[1].id) >= qt[1056].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1056].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1049].goal.getItem[1].id) >= qt[1049].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1049].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1056].goal.getItem[1].id) >= qt[1056].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1056].goal.getItem) then

--- npc_222003.lua
+++ npc_222003_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1050].goal.getItem[1].id) >= qt[1050].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1050].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1050].goal.getItem[1].id) >= qt[1050].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1050].goal.getItem) then

--- npc_222004.lua
+++ npc_222004_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1051].goal.getItem[1].id) >= qt[1051].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1051].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1057].goal.getItem[1].id) >= qt[1057].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1057].goal.getItem[2].id) >= qt[1057].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1057].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2675].goal.getItem[1].id) >= qt[2675].goal.getItem[1].count and qData[2675].killMonster[qt[2675].goal.killMonster[1].id] >= qt[2675].goal.killMonster[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2675].goal.getItem) and qData[2675].killMonster[qt[2675].goal.killMonster[1].id] >= qt[2675].goal.killMonster[1].count then
-     if CHECK_ITEM_CNT(qt[2676].goal.getItem[1].id) >= qt[2676].goal.getItem[1].count and qData[2676].killMonster[qt[2676].goal.killMonster[1].id] >= qt[2676].goal.killMonster[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2676].goal.getItem) and qData[2676].killMonster[qt[2676].goal.killMonster[1].id] >= qt[2676].goal.killMonster[1].count then
-       if CHECK_ITEM_CNT(qt[1051].goal.getItem[1].id) >= qt[1051].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1051].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1057].goal.getItem[1].id) >= qt[1057].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1057].goal.getItem[2].id) >= qt[1057].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1057].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2675].goal.getItem[1].id) >= qt[2675].goal.getItem[1].count and qData[2675].killMonster[qt[2675].goal.killMonster[1].id] >= qt[2675].goal.killMonster[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2675].goal.getItem) and qData[2675].killMonster[qt[2675].goal.killMonster[1].id] >= qt[2675].goal.killMonster[1].count then
-       if CHECK_ITEM_CNT(qt[2676].goal.getItem[1].id) >= qt[2676].goal.getItem[1].count and qData[2676].killMonster[qt[2676].goal.killMonster[1].id] >= qt[2676].goal.killMonster[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2676].goal.getItem) and qData[2676].killMonster[qt[2676].goal.killMonster[1].id] >= qt[2676].goal.killMonster[1].count then

--- npc_222006.lua
+++ npc_222006_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1055].goal.getItem[1].id) >= qt[1055].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1055].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2714].goal.getItem[1].id) >= qt[2714].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2714].goal.getItem[2].id) >= qt[2714].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2714].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2800].goal.getItem[1].id) >= qt[2800].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2800].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2801].goal.getItem[1].id) >= qt[2801].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2801].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2802].goal.getItem[1].id) >= qt[2802].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2802].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1055].goal.getItem[1].id) >= qt[1055].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1055].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2714].goal.getItem[1].id) >= qt[2714].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2714].goal.getItem[2].id) >= qt[2714].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2714].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2800].goal.getItem[1].id) >= qt[2800].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2800].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2801].goal.getItem[1].id) >= qt[2801].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2801].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2802].goal.getItem[1].id) >= qt[2802].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2802].goal.getItem) then

--- npc_240001.lua
+++ npc_240001_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2594].goal.getItem[1].id) >= qt[2594].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2594].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2596].goal.getItem[1].id) >= qt[2596].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2596].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2594].goal.getItem[1].id) >= qt[2594].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2594].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2596].goal.getItem[1].id) >= qt[2596].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2596].goal.getItem) then

--- npc_240002.lua
+++ npc_240002_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2181].goal.getItem[1].id) >= qt[2181].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2181].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[3644].goal.getItem[1].id) >= qt[3644].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3644].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[3702].goal.getItem[1].id) >= qt[3702].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3702].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2181].goal.getItem[1].id) >= qt[2181].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2181].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3644].goal.getItem[1].id) >= qt[3644].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3644].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3702].goal.getItem[1].id) >= qt[3702].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3702].goal.getItem) then

--- npc_240003.lua
+++ npc_240003_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2182].goal.getItem[1].id) >= qt[2182].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2182].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[3645].goal.getItem[1].id) >= qt[3645].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3645].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[3698].goal.getItem[1].id) >= qt[3698].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3698].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2182].goal.getItem[1].id) >= qt[2182].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2182].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3645].goal.getItem[1].id) >= qt[3645].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3645].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3698].goal.getItem[1].id) >= qt[3698].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3698].goal.getItem) then

--- npc_240004.lua
+++ npc_240004_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1479].goal.getItem[1].id) >= qt[1479].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1479].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2184].goal.getItem[1].id) >= qt[2184].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2184].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2588].goal.getItem[1].id) >= qt[2588].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2588].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2590].goal.getItem[1].id) >= qt[2590].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2590].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2598].goal.getItem[1].id) >= qt[2598].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2598].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[3647].goal.getItem[1].id) >= qt[3647].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3647].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2863].goal.getItem[1].id) >= qt[2863].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2863].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2869].goal.getItem[1].id) >= qt[2869].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2869].goal.getItem[2].id) >= qt[2869].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2869].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2871].goal.getItem[1].id) >= qt[2871].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2871].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2872].goal.getItem[1].id) >= qt[2872].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2872].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2873].goal.getItem[1].id) >= qt[2873].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2873].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2877].goal.getItem[1].id) >= qt[2877].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2877].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2878].goal.getItem[1].id) >= qt[2878].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2878].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2881].goal.getItem[1].id) >= qt[2881].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2881].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1479].goal.getItem[1].id) >= qt[1479].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1479].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2184].goal.getItem[1].id) >= qt[2184].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2184].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2588].goal.getItem[1].id) >= qt[2588].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2588].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2590].goal.getItem[1].id) >= qt[2590].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2590].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2598].goal.getItem[1].id) >= qt[2598].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2598].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3647].goal.getItem[1].id) >= qt[3647].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3647].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2863].goal.getItem[1].id) >= qt[2863].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2863].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2869].goal.getItem[1].id) >= qt[2869].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2869].goal.getItem[2].id) >= qt[2869].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2869].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2871].goal.getItem[1].id) >= qt[2871].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2871].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2872].goal.getItem[1].id) >= qt[2872].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2872].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2873].goal.getItem[1].id) >= qt[2873].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2873].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2877].goal.getItem[1].id) >= qt[2877].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2877].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2878].goal.getItem[1].id) >= qt[2878].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2878].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2881].goal.getItem[1].id) >= qt[2881].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2881].goal.getItem) then

--- npc_240005.lua
+++ npc_240005_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1478].goal.getItem[1].id) >= qt[1478].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1478].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1478].goal.getItem[1].id) >= qt[1478].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1478].goal.getItem) then

--- npc_240008.lua
+++ npc_240008_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[3699].goal.getItem[1].id) >= qt[3699].goal.getItem[1].count and CHECK_ITEM_CNT(qt[3699].goal.getItem[2].id) >= qt[3699].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3699].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[3700].goal.getItem[1].id) >= qt[3700].goal.getItem[1].count and CHECK_ITEM_CNT(qt[3700].goal.getItem[2].id) >= qt[3700].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3700].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[3703].goal.getItem[1].id) >= qt[3703].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3703].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3699].goal.getItem[1].id) >= qt[3699].goal.getItem[1].count and CHECK_ITEM_CNT(qt[3699].goal.getItem[2].id) >= qt[3699].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3699].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3700].goal.getItem[1].id) >= qt[3700].goal.getItem[1].count and CHECK_ITEM_CNT(qt[3700].goal.getItem[2].id) >= qt[3700].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3700].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3703].goal.getItem[1].id) >= qt[3703].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3703].goal.getItem) then

--- npc_241001.lua
+++ npc_241001_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[3736].goal.getItem[1].id) >= qt[3736].goal.getItem[1].count and CHECK_ITEM_CNT(qt[3736].goal.getItem[2].id) >= qt[3736].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3736].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3736].goal.getItem[1].id) >= qt[3736].goal.getItem[1].count and CHECK_ITEM_CNT(qt[3736].goal.getItem[2].id) >= qt[3736].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3736].goal.getItem) then

--- npc_241002.lua
+++ npc_241002_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[3787].goal.getItem[1].id) >= qt[3787].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3787].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3787].goal.getItem[1].id) >= qt[3787].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3787].goal.getItem) then

--- npc_241003.lua
+++ npc_241003_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2721].goal.getItem[1].id) >= qt[2721].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2721].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[3785].goal.getItem[1].id) >= qt[3785].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3785].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2721].goal.getItem[1].id) >= qt[2721].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2721].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3785].goal.getItem[1].id) >= qt[3785].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3785].goal.getItem) then

--- npc_241004.lua
+++ npc_241004_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2904].goal.getItem[1].id) >= qt[2904].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2904].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2910].goal.getItem[1].id) >= qt[2910].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2910].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2904].goal.getItem[1].id) >= qt[2904].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2904].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2910].goal.getItem[1].id) >= qt[2910].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2910].goal.getItem) then

--- npc_241006.lua
+++ npc_241006_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2903].goal.getItem[1].id) >= qt[2903].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2903].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2903].goal.getItem[1].id) >= qt[2903].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2903].goal.getItem) then

--- npc_300003.lua
+++ npc_300003_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2560].goal.getItem[1].id) >= qt[2560].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2560].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2561].goal.getItem[1].id) >= qt[2561].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2561].goal.getItem[2].id) >= qt[2561].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2561].goal.getItem) then
-   if qData[2706].state == 1 and CHECK_ITEM_CNT(qt[2706].goal.getItem[1].id) >= qt[2706].goal.getItem[1].count and GET_SEAL_BOX_SOUL_PERSENT(8590010) >= 100 then
+   if qData[2706].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[2706].goal.getItem) and GET_SEAL_BOX_SOUL_PERSENT(8590010) >= 100 then
-       if CHECK_ITEM_CNT(qt[2560].goal.getItem[1].id) >= qt[2560].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2560].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2561].goal.getItem[1].id) >= qt[2561].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2561].goal.getItem[2].id) >= qt[2561].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2561].goal.getItem) then
-   if qData[2706].state == 1 and CHECK_ITEM_CNT(qt[2706].goal.getItem[1].id) >= qt[2706].goal.getItem[1].count and GET_SEAL_BOX_SOUL_PERSENT(8590010) >= 100 then
+   if qData[2706].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[2706].goal.getItem) and GET_SEAL_BOX_SOUL_PERSENT(8590010) >= 100 then

--- npc_300007.lua
+++ npc_300007_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-   if qData[2654].state == 1 and CHECK_ITEM_CNT(qt[2654].goal.getItem[1].id) >= qt[2654].goal.getItem[1].count then
+   if qData[2654].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[2654].goal.getItem) then
-   if qData[2655].state == 1 and CHECK_ITEM_CNT(qt[2655].goal.getItem[1].id) >= qt[2655].goal.getItem[1].count then
+   if qData[2655].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[2655].goal.getItem) then
-   if qData[2654].state == 1 and CHECK_ITEM_CNT(qt[2654].goal.getItem[1].id) >= qt[2654].goal.getItem[1].count then
+   if qData[2654].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[2654].goal.getItem) then
-   if qData[2655].state == 1 and CHECK_ITEM_CNT(qt[2655].goal.getItem[1].id) >= qt[2655].goal.getItem[1].count then
+   if qData[2655].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[2655].goal.getItem) then

--- npc_300008.lua
+++ npc_300008_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-   if qData[718].state == 1 and CHECK_ITEM_CNT(qt[718].goal.getItem[1].id) >= qt[718].goal.getItem[1].count then
+   if qData[718].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[718].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[719].goal.getItem[1].id) >= qt[719].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[719].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[724].goal.getItem[1].id) >= qt[724].goal.getItem[1].count and CHECK_ITEM_CNT(qt[724].goal.getItem[2].id) >= qt[724].goal.getItem[2].count and CHECK_ITEM_CNT(qt[724].goal.getItem[3].id) >= qt[724].goal.getItem[3].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[724].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2190].goal.getItem[1].id) >= qt[2190].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2190].goal.getItem[2].id) >= qt[2190].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2190].goal.getItem) then
-   if qData[2197].state == 1 and CHECK_ITEM_CNT(qt[2197].goal.getItem[1].id) >= qt[2197].goal.getItem[1].count then
+   if qData[2197].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[2197].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2208].goal.getItem[1].id) >= qt[2208].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2208].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2210].goal.getItem[1].id) >= qt[2210].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2210].goal.getItem[2].id) >= qt[2210].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2210].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2211].goal.getItem[1].id) >= qt[2211].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2211].goal.getItem[2].id) >= qt[2211].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2211].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2212].goal.getItem[1].id) >= qt[2212].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2212].goal.getItem) then
-     if qData[2213].killMonster[qt[2213].goal.killMonster[1].id] >= qt[2213].goal.killMonster[1].count and CHECK_ITEM_CNT(qt[2213].goal.getItem[1].id) >= qt[2213].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2213].goal.getItem[2].id) >= qt[2213].goal.getItem[2].count and CHECK_ITEM_CNT(qt[2213].goal.getItem[3].id) >= qt[2213].goal.getItem[3].count and CHECK_ITEM_CNT(qt[2213].goal.getItem[4].id) >= qt[2213].goal.getItem[4].count and CHECK_ITEM_CNT(qt[2213].goal.getItem[5].id) >= qt[2213].goal.getItem[5].count then
+     if qData[2213].killMonster[qt[2213].goal.killMonster[1].id] >= qt[2213].goal.killMonster[1].count and __QUEST_HAS_ALL_ITEMS(qt[2213].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2324].goal.getItem[1].id) >= qt[2324].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2324].goal.getItem[2].id) >= qt[2324].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2324].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[719].goal.getItem[1].id) >= qt[719].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[719].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[724].goal.getItem[1].id) >= qt[724].goal.getItem[1].count and CHECK_ITEM_CNT(qt[724].goal.getItem[2].id) >= qt[724].goal.getItem[2].count and CHECK_ITEM_CNT(qt[724].goal.getItem[3].id) >= qt[724].goal.getItem[3].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[724].goal.getItem) then

--- npc_300009.lua
+++ npc_300009_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-   if qData[248].state == 1 and qData[247].state == 2 and CHECK_ITEM_CNT(qt[248].goal.getItem[1].id) >= qt[248].goal.getItem[1].count then
+   if qData[248].state == 1 and qData[247].state == 2 and __QUEST_HAS_ALL_ITEMS(qt[248].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[460].goal.getItem[1].id) >= qt[460].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[460].goal.getItem) then
-   if qData[1346].state == 1 and CHECK_ITEM_CNT(qt[1346].goal.getItem[1].id) >= qt[1346].goal.getItem[1].count then
+   if qData[1346].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1346].goal.getItem) then
-   if qData[248].state == 1 and qData[247].state == 2 and GET_PLAYER_LEVEL() >= qt[248].needLevel and CHECK_ITEM_CNT(qt[248].goal.getItem[1].id) >= qt[248].goal.getItem[1].count then
+   if qData[248].state == 1 and qData[247].state == 2 and GET_PLAYER_LEVEL() >= qt[248].needLevel and __QUEST_HAS_ALL_ITEMS(qt[248].goal.getItem) then

--- npc_300010.lua
+++ npc_300010_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-   if qData[136].state == 1 and CHECK_ITEM_CNT(qt[136].goal.getItem[1].id) >= qt[136].goal.getItem[1].count then
+   if qData[136].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[136].goal.getItem) then
-   if qData[242].state == 1 and qData[241].state == 2 and qData[243].state == 2 and CHECK_ITEM_CNT(qt[242].goal.getItem[1].id) >= qt[242].goal.getItem[1].count then
+   if qData[242].state == 1 and qData[241].state == 2 and qData[243].state == 2 and __QUEST_HAS_ALL_ITEMS(qt[242].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[456].goal.getItem[1].id) >= qt[456].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[456].goal.getItem) then
-   if qData[1241].state == 1 and CHECK_ITEM_CNT(qt[1241].goal.getItem[1].id) >= qt[1241].goal.getItem[1].count then
+   if qData[1241].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1241].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1242].goal.getItem[1].id) >= qt[1242].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1242].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1243].goal.getItem[1].id) >= qt[1243].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1243].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1244].goal.getItem[1].id) >= qt[1244].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1244].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[136].goal.getItem[1].id) >= qt[136].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[136].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[456].goal.getItem[1].id) >= qt[456].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[456].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1241].goal.getItem[1].id) >= qt[1241].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1241].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1243].goal.getItem[1].id) >= qt[1243].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1243].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1244].goal.getItem[1].id) >= qt[1244].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1244].goal.getItem) then

--- npc_300011.lua
+++ npc_300011_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-   if qData[91].state == 1 and CHECK_ITEM_CNT(qt[91].goal.getItem[1].id) >= qt[91].goal.getItem[1].count then
+   if qData[91].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[91].goal.getItem) then
-   if qData[133].state == 1 and CHECK_ITEM_CNT(qt[133].goal.getItem[1].id) >= qt[133].goal.getItem[1].count and CHECK_ITEM_CNT(qt[133].goal.getItem[2].id) >= qt[133].goal.getItem[2].count then
+   if qData[133].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[133].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[134].goal.getItem[1].id) >= qt[134].goal.getItem[1].count and CHECK_ITEM_CNT(qt[134].goal.getItem[2].id) >= qt[134].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[134].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[135].goal.getItem[1].id) >= qt[135].goal.getItem[1].count and SET_ITEM_PERCENT(8510061) >= 371 then
+     if __QUEST_HAS_ALL_ITEMS(qt[135].goal.getItem) and SET_ITEM_PERCENT(8510061) >= 371 then
-     if CHECK_ITEM_CNT(qt[1005].goal.getItem[1].id) >= qt[1005].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1005].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1207].goal.getItem[1].id) >= qt[1207].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1207].goal.getItem[2].id) >= qt[1207].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1207].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1210].goal.getItem[1].id) >= qt[1210].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1210].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2066].goal.getItem[1].id) >= qt[2066].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2066].goal.getItem[2].id) >= qt[2066].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2066].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2067].goal.getItem[1].id) >= qt[2067].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2067].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2068].goal.getItem[1].id) >= qt[2068].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2068].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2898].goal.getItem[1].id) >= qt[2898].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2898].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[91].goal.getItem[1].id) >= qt[91].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[91].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1005].goal.getItem[1].id) >= qt[1005].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1005].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1207].goal.getItem[1].id) >= qt[1207].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1207].goal.getItem[2].id) >= qt[1207].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1207].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1210].goal.getItem[1].id) >= qt[1210].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1210].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2066].goal.getItem[1].id) >= qt[2066].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2066].goal.getItem[2].id) >= qt[2066].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2066].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2067].goal.getItem[1].id) >= qt[2067].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2067].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2068].goal.getItem[1].id) >= qt[2068].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2068].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2898].goal.getItem[1].id) >= qt[2898].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2898].goal.getItem) then

--- npc_300012.lua
+++ npc_300012_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-   if qData[1132].state == 1 and CHECK_ITEM_CNT(qt[1132].goal.getItem[1].id) >= qt[1132].goal.getItem[1].count then
+   if qData[1132].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1132].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1133].goal.getItem[1].id) >= qt[1133].goal.getItem[1].count and GET_SEAL_BOX_SOUL_PERSENT(8510011) >= 100 then
+     if __QUEST_HAS_ALL_ITEMS(qt[1133].goal.getItem) and GET_SEAL_BOX_SOUL_PERSENT(8510011) >= 100 then
-     if CHECK_ITEM_CNT(qt[2025].goal.getItem[1].id) >= qt[2025].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2025].goal.getItem) then
-   if qData[2065].state == 1 and CHECK_ITEM_CNT(qt[2065].goal.getItem[1].id) >= qt[2065].goal.getItem[1].count then
+   if qData[2065].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[2065].goal.getItem) then
-   if qData[1132].state ~= 2 and GET_PLAYER_LEVEL() >= qt[1132].needLevel and qData[1132].state == 1 and CHECK_ITEM_CNT(qt[1132].goal.getItem[1].id) >= qt[1132].goal.getItem[1].count then
+   if qData[1132].state ~= 2 and GET_PLAYER_LEVEL() >= qt[1132].needLevel and qData[1132].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1132].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1133].goal.getItem[1].id) >= qt[1133].goal.getItem[1].count and GET_SEAL_BOX_SOUL_PERSENT(qt[1133].goal.getItem[1].id) >= 100 then
+       if __QUEST_HAS_ALL_ITEMS(qt[1133].goal.getItem) and GET_SEAL_BOX_SOUL_PERSENT(__QUEST_FIRST_ITEM_ID(qt[1133].goal.getItem)) >= 100 then
-     if CHECK_ITEM_CNT(qt[2025].goal.getItem[1].id) >= qt[2025].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2025].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2065].goal.getItem[1].id) >= qt[2065].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2065].goal.getItem) then

--- npc_300111.lua
+++ npc_300111_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1339].goal.getItem[1].id) >= qt[1339].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1339].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1340].goal.getItem[1].id) >= qt[1340].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1340].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1342].goal.getItem[1].id) >= qt[1342].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1342].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1339].goal.getItem[1].id) >= qt[1339].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1339].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1340].goal.getItem[1].id) >= qt[1340].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1340].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1342].goal.getItem[1].id) >= qt[1342].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1342].goal.getItem) then

--- npc_300117.lua
+++ npc_300117_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-   if qData[1801].state == 1 and CHECK_ITEM_CNT(qt[1801].goal.getItem[1].id) >= qt[1801].goal.getItem[1].count then
+   if qData[1801].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1801].goal.getItem) then
-   if qData[1802].state == 1 and CHECK_ITEM_CNT(qt[1802].goal.getItem[1].id) >= qt[1802].goal.getItem[1].count then
+   if qData[1802].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1802].goal.getItem) then
-   if qData[1803].state == 1 and CHECK_ITEM_CNT(qt[1803].goal.getItem[1].id) >= qt[1803].goal.getItem[1].count and qData[1803].killMonster[qt[1803].goal.killMonster[1].id] >= qt[1803].goal.killMonster[1].count then
+   if qData[1803].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1803].goal.getItem) and qData[1803].killMonster[qt[1803].goal.killMonster[1].id] >= qt[1803].goal.killMonster[1].count then
-   if qData[1804].state == 1 and CHECK_ITEM_CNT(qt[1804].goal.getItem[1].id) >= qt[1804].goal.getItem[1].count then
+   if qData[1804].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1804].goal.getItem) then
-   if qData[1805].state == 1 and CHECK_ITEM_CNT(qt[1805].goal.getItem[1].id) >= qt[1805].goal.getItem[1].count then
+   if qData[1805].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1805].goal.getItem) then
-   if qData[1806].state == 1 and CHECK_ITEM_CNT(qt[1806].goal.getItem[1].id) >= qt[1806].goal.getItem[1].count and qData[1806].killMonster[qt[1806].goal.killMonster[1].id] >= qt[1806].goal.killMonster[1].count then
+   if qData[1806].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1806].goal.getItem) and qData[1806].killMonster[qt[1806].goal.killMonster[1].id] >= qt[1806].goal.killMonster[1].count then
-   if qData[1810].state == 1 and CHECK_ITEM_CNT(qt[1810].goal.getItem[1].id) >= qt[1810].goal.getItem[1].count and qData[1810].killMonster[qt[1810].goal.killMonster[1].id] >= qt[1810].goal.killMonster[1].count then
+   if qData[1810].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1810].goal.getItem) and qData[1810].killMonster[qt[1810].goal.killMonster[1].id] >= qt[1810].goal.killMonster[1].count then
-   if qData[1811].state == 1 and CHECK_ITEM_CNT(qt[1811].goal.getItem[1].id) >= qt[1811].goal.getItem[1].count then
+   if qData[1811].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1811].goal.getItem) then
-   if qData[1812].state == 1 and CHECK_ITEM_CNT(qt[1812].goal.getItem[1].id) >= qt[1812].goal.getItem[1].count then
+   if qData[1812].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1812].goal.getItem) then
-   if qData[1813].state == 1 and CHECK_ITEM_CNT(qt[1813].goal.getItem[1].id) >= qt[1813].goal.getItem[1].count then
+   if qData[1813].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1813].goal.getItem) then
-   if qData[1814].state == 1 and CHECK_ITEM_CNT(qt[1814].goal.getItem[1].id) >= qt[1814].goal.getItem[1].count then
+   if qData[1814].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1814].goal.getItem) then
-   if qData[1815].state == 1 and CHECK_ITEM_CNT(qt[1815].goal.getItem[1].id) >= qt[1815].goal.getItem[1].count then
+   if qData[1815].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1815].goal.getItem) then
-   if qData[1816].state == 1 and CHECK_ITEM_CNT(qt[1816].goal.getItem[1].id) >= qt[1816].goal.getItem[1].count then
+   if qData[1816].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1816].goal.getItem) then
-   if qData[1817].state == 1 and CHECK_ITEM_CNT(qt[1817].goal.getItem[1].id) >= qt[1817].goal.getItem[1].count then
+   if qData[1817].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1817].goal.getItem) then
-   if qData[1818].state == 1 and CHECK_ITEM_CNT(qt[1818].goal.getItem[1].id) >= qt[1818].goal.getItem[1].count then
+   if qData[1818].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1818].goal.getItem) then
-   if qData[1819].state == 1 and CHECK_ITEM_CNT(qt[1819].goal.getItem[1].id) >= qt[1819].goal.getItem[1].count then
+   if qData[1819].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1819].goal.getItem) then
-   if qData[1820].state == 1 and CHECK_ITEM_CNT(qt[1820].goal.getItem[1].id) >= qt[1820].goal.getItem[1].count then
+   if qData[1820].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1820].goal.getItem) then
-   if qData[1822].state == 1 and CHECK_ITEM_CNT(qt[1822].goal.getItem[1].id) >= qt[1822].goal.getItem[1].count then
+   if qData[1822].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1822].goal.getItem) then
-   if qData[1825].state == 1 and CHECK_ITEM_CNT(qt[1825].goal.getItem[1].id) >= qt[1825].goal.getItem[1].count then
+   if qData[1825].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1825].goal.getItem) then
-   if qData[1826].state == 1 and CHECK_ITEM_CNT(qt[1826].goal.getItem[1].id) >= qt[1826].goal.getItem[1].count then
+   if qData[1826].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1826].goal.getItem) then
-   if qData[1827].state == 1 and CHECK_ITEM_CNT(qt[1827].goal.getItem[1].id) >= qt[1827].goal.getItem[1].count then
+   if qData[1827].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1827].goal.getItem) then
-   if qData[1828].state == 1 and CHECK_ITEM_CNT(qt[1828].goal.getItem[1].id) >= qt[1828].goal.getItem[1].count then
+   if qData[1828].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1828].goal.getItem) then
-   if qData[1829].state == 1 and CHECK_ITEM_CNT(qt[1829].goal.getItem[1].id) >= qt[1829].goal.getItem[1].count then
+   if qData[1829].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1829].goal.getItem) then
-   if qData[1830].state == 1 and CHECK_ITEM_CNT(qt[1830].goal.getItem[1].id) >= qt[1830].goal.getItem[1].count then
+   if qData[1830].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1830].goal.getItem) then
-   if qData[1831].state == 1 and CHECK_ITEM_CNT(qt[1831].goal.getItem[1].id) >= qt[1831].goal.getItem[1].count then
+   if qData[1831].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1831].goal.getItem) then

--- npc_300119.lua
+++ npc_300119_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1402].goal.getItem[1].id) >= qt[1402].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1402].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2008].goal.getItem[1].id) >= qt[2008].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2008].goal.getItem) then

--- npc_300127.lua
+++ npc_300127_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1409].goal.getItem[1].id) >= qt[1409].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1409].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1410].goal.getItem[1].id) >= qt[1410].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1410].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1411].goal.getItem[1].id) >= qt[1411].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1411].goal.getItem[2].id) >= qt[1411].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1411].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1411].goal.getItem[1].id) >= qt[1411].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1411].goal.getItem[2].id) >= qt[1411].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1411].goal.getItem) then

--- npc_300128.lua
+++ npc_300128_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2012].goal.getItem[1].id) >= qt[2012].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2012].goal.getItem[2].id) >= qt[2012].goal.getItem[2].count and CHECK_ITEM_CNT(qt[2012].goal.getItem[3].id) >= qt[2012].goal.getItem[3].count and CHECK_ITEM_CNT(qt[2012].goal.getItem[4].id) >= qt[2012].goal.getItem[4].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2012].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2013].goal.getItem[1].id) >= qt[2013].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2013].goal.getItem[2].id) >= qt[2013].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2013].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2014].goal.getItem[1].id) >= qt[2014].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2014].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2012].goal.getItem[1].id) >= qt[2012].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2012].goal.getItem[2].id) >= qt[2012].goal.getItem[2].count and CHECK_ITEM_CNT(qt[2012].goal.getItem[3].id) >= qt[2012].goal.getItem[3].count and CHECK_ITEM_CNT(qt[2012].goal.getItem[4].id) >= qt[2012].goal.getItem[4].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2012].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2013].goal.getItem[1].id) >= qt[2013].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2013].goal.getItem[2].id) >= qt[2013].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2013].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2014].goal.getItem[1].id) >= qt[2014].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2014].goal.getItem) then

--- npc_300135.lua
+++ npc_300135_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2177].goal.getItem[1].id) >= qt[2177].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2177].goal.getItem[2].id) >= qt[2177].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2177].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2178].goal.getItem[1].id) >= qt[2178].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2178].goal.getItem[2].id) >= qt[2178].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2178].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2179].goal.getItem[1].id) >= qt[2179].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2179].goal.getItem[2].id) >= qt[2179].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2179].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2180].goal.getItem[1].id) >= qt[2180].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2180].goal.getItem[2].id) >= qt[2180].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2180].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[3643].goal.getItem[1].id) >= qt[3643].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3643].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2177].goal.getItem[1].id) >= qt[2177].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2177].goal.getItem[2].id) >= qt[2177].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2177].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2178].goal.getItem[1].id) >= qt[2178].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2178].goal.getItem[2].id) >= qt[2178].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2178].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2179].goal.getItem[1].id) >= qt[2179].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2179].goal.getItem[2].id) >= qt[2179].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2179].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2180].goal.getItem[1].id) >= qt[2180].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2180].goal.getItem[2].id) >= qt[2180].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2180].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3643].goal.getItem[1].id) >= qt[3643].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3643].goal.getItem) then

--- npc_300139.lua
+++ npc_300139_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[3706].goal.getItem[1].id) >= qt[3706].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3706].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3706].goal.getItem[1].id) >= qt[3706].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3706].goal.getItem) then

--- npc_300145.lua
+++ npc_300145_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2582].goal.getItem[1].id) >= qt[2582].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2582].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2582].goal.getItem[1].id) >= qt[2582].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2582].goal.getItem) then

--- npc_300155.lua
+++ npc_300155_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[3711].goal.getItem[1].id) >= qt[3711].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3711].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3711].goal.getItem[1].id) >= qt[3711].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3711].goal.getItem) then

--- npc_300164.lua
+++ npc_300164_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-       if CHECK_ITEM_CNT(qt[3744].goal.getItem[1].id) >= qt[3744].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3744].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3744].goal.getItem[1].id) >= qt[3744].goal.getItem[1].count and qData[3745].state ~= 2 then
+       if __QUEST_HAS_ALL_ITEMS(qt[3744].goal.getItem) and qData[3745].state ~= 2 then

--- npc_300165.lua
+++ npc_300165_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-       if CHECK_ITEM_CNT(qt[3745].goal.getItem[1].id) >= qt[3745].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3745].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3745].goal.getItem[1].id) >= qt[3745].goal.getItem[1].count and qData[3744].state ~= 2 then
+       if __QUEST_HAS_ALL_ITEMS(qt[3745].goal.getItem) and qData[3744].state ~= 2 then

--- npc_300166.lua
+++ npc_300166_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2751].goal.getItem[1].id) >= qt[2751].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2751].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2751].goal.getItem[1].id) >= qt[2751].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2751].goal.getItem) then

--- npc_300167.lua
+++ npc_300167_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2846].goal.getItem[1].id) >= qt[2846].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2846].goal.getItem[2].id) >= qt[2846].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2846].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2846].goal.getItem[1].id) >= qt[2846].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2846].goal.getItem[2].id) >= qt[2846].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2846].goal.getItem) then

--- npc_300169.lua
+++ npc_300169_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[3747].goal.getItem[1].id) >= qt[3747].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3747].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3747].goal.getItem[1].id) >= qt[3747].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3747].goal.getItem) then

--- npc_300170.lua
+++ npc_300170_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[3751].goal.getItem[1].id) >= qt[3751].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3751].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3751].goal.getItem[1].id) >= qt[3751].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3751].goal.getItem) then

--- npc_300173.lua
+++ npc_300173_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[3756].goal.getItem[1].id) >= qt[3756].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3756].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3756].goal.getItem[1].id) >= qt[3756].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3756].goal.getItem) then

--- npc_300174.lua
+++ npc_300174_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[3768].goal.getItem[1].id) >= qt[3768].goal.getItem[1].count and CHECK_ITEM_CNT(qt[3768].goal.getItem[2].id) >= qt[3768].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3768].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3768].goal.getItem[1].id) >= qt[3768].goal.getItem[1].count and CHECK_ITEM_CNT(qt[3768].goal.getItem[2].id) >= qt[3768].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3768].goal.getItem) then

--- npc_301002.lua
+++ npc_301002_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-   if qData[1078].state == 1 and CHECK_ITEM_CNT(qt[1078].goal.getItem[1].id) >= qt[1078].goal.getItem[1].count then
+   if qData[1078].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1078].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1078].goal.getItem[1].id) >= qt[1078].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1078].goal.getItem) then

--- npc_310003.lua
+++ npc_310003_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[560].goal.getItem[1].id) >= qt[560].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[560].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[561].goal.getItem[1].id) >= qt[561].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[561].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1222].goal.getItem[1].id) >= qt[1222].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1222].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[560].goal.getItem[1].id) >= qt[560].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[560].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[561].goal.getItem[1].id) >= qt[561].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[561].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1222].goal.getItem[1].id) >= qt[1222].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1222].goal.getItem) then

--- npc_310005.lua
+++ npc_310005_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[202].goal.getItem[1].id) >= qt[202].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[202].goal.getItem) then
-     elseif CHECK_ITEM_CNT(qt[246].goal.getItem[1].id) >= qt[246].goal.getItem[1].count and CHECK_ITEM_CNT(qt[246].goal.getItem[2].id) >= qt[246].goal.getItem[2].count and CHECK_ITEM_CNT(qt[246].goal.getItem[3].id) >= qt[246].goal.getItem[3].count and CHECK_ITEM_CNT(qt[246].goal.getItem[4].id) >= qt[246].goal.getItem[4].count then
+     elseif __QUEST_HAS_ALL_ITEMS(qt[246].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[277].goal.getItem[1].id) >= qt[277].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[277].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[280].goal.getItem[1].id) >= qt[282].goal.getItem[1].count then
+     if CHECK_ITEM_CNT(__QUEST_FIRST_ITEM_ID(qt[280].goal.getItem)) >= __QUEST_FIRST_ITEM_COUNT(qt[282].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[282].goal.getItem[1].id) >= qt[282].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[282].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[464].goal.getItem[1].id) >= qt[464].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[464].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[465].goal.getItem[1].id) >= qt[465].goal.getItem[1].count and CHECK_ITEM_CNT(qt[465].goal.getItem[2].id) >= qt[465].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[465].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[466].goal.getItem[1].id) >= qt[466].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[466].goal.getItem) then
-   if qData[1219].state == 1 and CHECK_ITEM_CNT(qt[1219].goal.getItem[1].id) >= qt[1219].goal.getItem[1].count then
+   if qData[1219].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1219].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1220].goal.getItem[1].id) >= qt[1220].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1220].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1227].goal.getItem[1].id) >= qt[1227].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1227].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1319].goal.getItem[1].id) >= qt[1319].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1319].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1320].goal.getItem[1].id) >= qt[1320].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1320].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1321].goal.getItem[1].id) >= qt[1321].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1321].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1322].goal.getItem[1].id) >= qt[1322].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1322].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[277].goal.getItem[1].id) >= qt[277].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[277].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[464].goal.getItem[1].id) >= qt[464].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[464].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[465].goal.getItem[1].id) >= qt[465].goal.getItem[1].count and CHECK_ITEM_CNT(qt[465].goal.getItem[2].id) >= qt[465].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[465].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[466].goal.getItem[1].id) >= qt[466].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[466].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1219].goal.getItem[1].id) >= qt[1219].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1219].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1220].goal.getItem[1].id) >= qt[1220].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1220].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1227].goal.getItem[1].id) >= qt[1227].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1227].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1319].goal.getItem[1].id) >= qt[1319].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1319].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1320].goal.getItem[1].id) >= qt[1320].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1320].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1321].goal.getItem[1].id) >= qt[1321].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1321].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1322].goal.getItem[1].id) >= qt[1322].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1322].goal.getItem) then

--- npc_313002.lua
+++ npc_313002_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[76].goal.getItem[1].id) >= qt[76].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[76].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[106].goal.getItem[1].id) >= qt[106].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[106].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[198].goal.getItem[1].id) >= qt[198].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[198].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[200].goal.getItem[1].id) >= qt[200].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[200].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1214].goal.getItem[1].id) >= qt[1214].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1214].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1415].goal.getItem[1].id) >= qt[1415].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1415].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[198].goal.getItem[1].id) >= qt[198].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[198].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1214].goal.getItem[1].id) >= qt[1214].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1214].goal.getItem) then

--- npc_313003.lua
+++ npc_313003_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1501].goal.getItem[1].id) >= qt[1501].goal.getItem[1].count and SET_ITEM_PERCENT(8590001) == 300 then
+     if __QUEST_HAS_ALL_ITEMS(qt[1501].goal.getItem) and SET_ITEM_PERCENT(8590001) == 300 then
-     if CHECK_ITEM_CNT(qt[1501].goal.getItem[1].id) >= qt[1501].goal.getItem[1].count and SET_ITEM_PERCENT(8590001) == 300 then
+     if __QUEST_HAS_ALL_ITEMS(qt[1501].goal.getItem) and SET_ITEM_PERCENT(8590001) == 300 then

--- npc_313004.lua
+++ npc_313004_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-   if qData[1236].state == 1 and CHECK_ITEM_CNT(qt[1236].goal.getItem[1].id) >= qt[1236].goal.getItem[1].count then
+   if qData[1236].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1236].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1236].goal.getItem[1].id) >= qt[1236].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1236].goal.getItem) then

--- npc_313005.lua
+++ npc_313005_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-   if qData[336].state == 1 and CHECK_ITEM_CNT(qt[336].goal.getItem[1].id) >= qt[336].goal.getItem[1].count then
+   if qData[336].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[336].goal.getItem) then

--- npc_313006.lua
+++ npc_313006_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-       if CHECK_ITEM_CNT(qt[85].goal.getItem[1].id) >= qt[85].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[85].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1234].goal.getItem[1].id) >= qt[1234].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1234].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[85].goal.getItem[1].id) >= qt[85].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[85].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1234].goal.getItem[1].id) >= qt[1234].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1234].goal.getItem) then

--- npc_313007.lua
+++ npc_313007_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-   if qData[1229].state == 1 and CHECK_ITEM_CNT(qt[1229].goal.getItem[1].id) >= qt[1229].goal.getItem[1].count then
+   if qData[1229].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1229].goal.getItem) then
-   if qData[1231].state == 1 and CHECK_ITEM_CNT(qt[1231].goal.getItem[1].id) >= qt[1231].goal.getItem[1].count then
+   if qData[1231].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1231].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1232].goal.getItem[1].id) >= qt[1232].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1232].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1239].goal.getItem[1].id) >= qt[1239].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1239].goal.getItem) then
-   if qData[2073].state == 1 and CHECK_ITEM_CNT(qt[2073].goal.getItem[1].id) >= qt[2073].goal.getItem[1].count then
+   if qData[2073].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[2073].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2074].goal.getItem[1].id) >= qt[2074].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2074].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2075].goal.getItem[1].id) >= qt[2075].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2075].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2077].goal.getItem[1].id) >= qt[2077].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2077].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2078].goal.getItem[1].id) >= qt[2078].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2078].goal.getItem) then
-   if qData[1229].state == 1 and CHECK_ITEM_CNT(qt[1229].goal.getItem[1].id) >= qt[1229].goal.getItem[1].count then
+   if qData[1229].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1229].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1231].goal.getItem[1].id) >= qt[1231].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1231].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1232].goal.getItem[1].id) >= qt[1232].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1232].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1239].goal.getItem[1].id) >= qt[1239].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1239].goal.getItem) then
-   if qData[2073].state == 1 and CHECK_ITEM_CNT(qt[2073].goal.getItem[1].id) >= qt[2073].goal.getItem[1].count then
+   if qData[2073].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[2073].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2074].goal.getItem[1].id) >= qt[2074].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2074].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2075].goal.getItem[1].id) >= qt[2075].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2075].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2077].goal.getItem[1].id) >= qt[2077].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2077].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2078].goal.getItem[1].id) >= qt[2078].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2078].goal.getItem) then

--- npc_314001.lua
+++ npc_314001_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1130].goal.getItem[1].id) >= qt[1130].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1130].goal.getItem[2].id) >= qt[1130].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1130].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1130].goal.getItem[1].id) >= qt[1130].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1130].goal.getItem[2].id) >= qt[1130].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1130].goal.getItem) then

--- npc_314003.lua
+++ npc_314003_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1141].goal.getItem[1].id) >= qt[1141].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1141].goal.getItem[2].id) >= qt[1141].goal.getItem[2].count and CHECK_ITEM_CNT(qt[1141].goal.getItem[3].id) >= qt[1141].goal.getItem[3].count and CHECK_ITEM_CNT(qt[1141].goal.getItem[4].id) >= qt[1141].goal.getItem[4].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1141].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2024].goal.getItem[1].id) >= qt[2024].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2024].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1141].goal.getItem[1].id) >= qt[1141].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1141].goal.getItem[2].id) >= qt[1141].goal.getItem[2].count and CHECK_ITEM_CNT(qt[1141].goal.getItem[3].id) >= qt[1141].goal.getItem[3].count and CHECK_ITEM_CNT(qt[1141].goal.getItem[4].id) >= qt[1141].goal.getItem[4].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1141].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2024].goal.getItem[1].id) >= qt[2024].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2024].goal.getItem) then

--- npc_314004.lua
+++ npc_314004_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1131].goal.getItem[1].id) >= qt[1131].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1131].goal.getItem[2].id) >= qt[1131].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1131].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1131].goal.getItem[1].id) >= qt[1131].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1131].goal.getItem[2].id) >= qt[1131].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1131].goal.getItem) then

--- npc_314006.lua
+++ npc_314006_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1119].goal.getItem[1].id) >= qt[1119].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1119].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1119].goal.getItem[1].id) >= qt[1119].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1119].goal.getItem) then

--- npc_314007.lua
+++ npc_314007_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-   if qData[1116].state == 1 and CHECK_ITEM_CNT(qt[1116].goal.getItem[1].id) >= qt[1116].goal.getItem[1].count then
+   if qData[1116].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1116].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1143].goal.getItem[1].id) >= qt[1143].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1143].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1116].goal.getItem[1].id) >= qt[1116].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1116].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1143].goal.getItem[1].id) >= qt[1143].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1143].goal.getItem) then

--- npc_314008.lua
+++ npc_314008_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1142].goal.getItem[1].id) >= qt[1142].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1142].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1142].goal.getItem[1].id) >= qt[1142].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1142].goal.getItem) then

--- npc_314010.lua
+++ npc_314010_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[280].goal.getItem[1].id) >= qt[280].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[280].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[280].goal.getItem[1].id) >= qt[280].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[280].goal.getItem) then

--- npc_314011.lua
+++ npc_314011_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[279].goal.getItem[1].id) >= qt[279].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[279].goal.getItem) then

--- npc_314012.lua
+++ npc_314012_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1418].goal.getItem[1].id) >= qt[1418].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1418].goal.getItem) then

--- npc_314020.lua
+++ npc_314020_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-   if qData[112].state == 1 and CHECK_ITEM_CNT(qt[112].goal.getItem[1].id) >= qt[112].goal.getItem[1].count then
+   if qData[112].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[112].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[123].goal.getItem[1].id) >= qt[123].goal.getItem[1].count and CHECK_ITEM_CNT(qt[123].goal.getItem[2].id) >= qt[123].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[123].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[124].goal.getItem[1].id) >= qt[124].goal.getItem[1].count and CHECK_ITEM_CNT(qt[124].goal.getItem[2].id) >= qt[124].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[124].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[125].goal.getItem[1].id) >= qt[125].goal.getItem[1].count and CHECK_ITEM_CNT(qt[125].goal.getItem[2].id) >= qt[125].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[125].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[382].goal.getItem[1].id) >= qt[382].goal.getItem[1].count and CHECK_ITEM_CNT(qt[382].goal.getItem[2].id) >= qt[382].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[382].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[631].goal.getItem[1].id) >= qt[631].goal.getItem[1].count and CHECK_ITEM_CNT(qt[631].goal.getItem[2].id) >= qt[631].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[631].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2087].goal.getItem[1].id) >= qt[2087].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2087].goal.getItem[2].id) >= qt[2087].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2087].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[64].goal.getItem[1].id) >= qt[64].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[64].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[170].goal.getItem[1].id) >= qt[170].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[170].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[176].goal.getItem[1].id) >= qt[176].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[176].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[182].goal.getItem[1].id) >= qt[182].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[182].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[386].goal.getItem[1].id) >= qt[386].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[386].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[636].goal.getItem[1].id) >= qt[636].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[636].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[637].goal.getItem[1].id) >= qt[637].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[637].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2093].goal.getItem[1].id) >= qt[2093].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2093].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1124].goal.getItem[1].id) >= qt[1124].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1124].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1125].goal.getItem[1].id) >= qt[1125].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1125].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1147].goal.getItem[1].id) >= qt[1147].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1147].goal.getItem) then
-   if qData[1177].state == 1 and CHECK_ITEM_CNT(qt[1177].goal.getItem[1].id) >= qt[1177].goal.getItem[1].count then
+   if qData[1177].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1177].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1179].goal.getItem[1].id) >= qt[1179].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1179].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1404].goal.getItem[1].id) >= qt[1404].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1404].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[64].goal.getItem[1].id) >= qt[64].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[64].goal.getItem) then
-         if CHECK_ITEM_CNT(qt[123].goal.getItem[1].id) >= qt[123].goal.getItem[1].count and CHECK_ITEM_CNT(qt[123].goal.getItem[2].id) >= qt[123].goal.getItem[2].count then
+         if __QUEST_HAS_ALL_ITEMS(qt[123].goal.getItem) then
-         if CHECK_ITEM_CNT(qt[124].goal.getItem[1].id) >= qt[124].goal.getItem[1].count and CHECK_ITEM_CNT(qt[124].goal.getItem[2].id) >= qt[124].goal.getItem[2].count then
+         if __QUEST_HAS_ALL_ITEMS(qt[124].goal.getItem) then
-         if CHECK_ITEM_CNT(qt[125].goal.getItem[1].id) >= qt[125].goal.getItem[1].count and CHECK_ITEM_CNT(qt[125].goal.getItem[2].id) >= qt[125].goal.getItem[2].count then
+         if __QUEST_HAS_ALL_ITEMS(qt[125].goal.getItem) then
-         if CHECK_ITEM_CNT(qt[382].goal.getItem[1].id) >= qt[382].goal.getItem[1].count and CHECK_ITEM_CNT(qt[382].goal.getItem[2].id) >= qt[382].goal.getItem[2].count then
+         if __QUEST_HAS_ALL_ITEMS(qt[382].goal.getItem) then
-         if CHECK_ITEM_CNT(qt[631].goal.getItem[1].id) >= qt[631].goal.getItem[1].count and CHECK_ITEM_CNT(qt[631].goal.getItem[2].id) >= qt[631].goal.getItem[2].count then
+         if __QUEST_HAS_ALL_ITEMS(qt[631].goal.getItem) then
-         if CHECK_ITEM_CNT(qt[2087].goal.getItem[1].id) >= qt[2087].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2087].goal.getItem[2].id) >= qt[2087].goal.getItem[2].count then
+         if __QUEST_HAS_ALL_ITEMS(qt[2087].goal.getItem) then
-           if CHECK_ITEM_CNT(qt[170].goal.getItem[1].id) >= qt[170].goal.getItem[1].count then
+           if __QUEST_HAS_ALL_ITEMS(qt[170].goal.getItem) then
-           if CHECK_ITEM_CNT(qt[176].goal.getItem[1].id) >= qt[176].goal.getItem[1].count then
+           if __QUEST_HAS_ALL_ITEMS(qt[176].goal.getItem) then
-           if CHECK_ITEM_CNT(qt[182].goal.getItem[1].id) >= qt[182].goal.getItem[1].count then
+           if __QUEST_HAS_ALL_ITEMS(qt[182].goal.getItem) then
-           if CHECK_ITEM_CNT(qt[386].goal.getItem[1].id) >= qt[386].goal.getItem[1].count then
+           if __QUEST_HAS_ALL_ITEMS(qt[386].goal.getItem) then
-           if CHECK_ITEM_CNT(qt[636].goal.getItem[1].id) >= qt[636].goal.getItem[1].count then
+           if __QUEST_HAS_ALL_ITEMS(qt[636].goal.getItem) then
-           if CHECK_ITEM_CNT(qt[637].goal.getItem[1].id) >= qt[637].goal.getItem[1].count then
+           if __QUEST_HAS_ALL_ITEMS(qt[637].goal.getItem) then
-           if CHECK_ITEM_CNT(qt[2093].goal.getItem[1].id) >= qt[2093].goal.getItem[1].count then
+           if __QUEST_HAS_ALL_ITEMS(qt[2093].goal.getItem) then
-           if CHECK_ITEM_CNT(qt[2094].goal.getItem[1].id) >= qt[2094].goal.getItem[1].count then
+           if __QUEST_HAS_ALL_ITEMS(qt[2094].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1124].goal.getItem[1].id) >= qt[1124].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1124].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1125].goal.getItem[1].id) >= qt[1125].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1125].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1147].goal.getItem[1].id) >= qt[1147].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1147].goal.getItem) then
-   if qData[1175].state == 2 and qData[1177].state ~= 2 and qData[1177].state == 1 and CHECK_ITEM_CNT(qt[1177].goal.getItem[1].id) >= qt[1177].goal.getItem[1].count then
+   if qData[1175].state == 2 and qData[1177].state ~= 2 and qData[1177].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1177].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1179].goal.getItem[1].id) >= qt[1179].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1179].goal.getItem) then

--- npc_314021.lua
+++ npc_314021_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-   if qData[113].state == 1 and CHECK_ITEM_CNT(qt[113].goal.getItem[1].id) >= qt[113].goal.getItem[1].count then
+   if qData[113].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[113].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[118].goal.getItem[1].id) >= qt[118].goal.getItem[1].count and CHECK_ITEM_CNT(qt[118].goal.getItem[2].id) >= qt[118].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[118].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[119].goal.getItem[1].id) >= qt[119].goal.getItem[1].count and CHECK_ITEM_CNT(qt[119].goal.getItem[2].id) >= qt[119].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[119].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[120].goal.getItem[1].id) >= qt[120].goal.getItem[1].count and CHECK_ITEM_CNT(qt[120].goal.getItem[2].id) >= qt[120].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[120].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[381].goal.getItem[1].id) >= qt[381].goal.getItem[1].count and CHECK_ITEM_CNT(qt[381].goal.getItem[2].id) >= qt[381].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[381].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[627].goal.getItem[1].id) >= qt[627].goal.getItem[1].count and CHECK_ITEM_CNT(qt[627].goal.getItem[2].id) >= qt[627].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[627].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2083].goal.getItem[1].id) >= qt[2083].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2083].goal.getItem[2].id) >= qt[2083].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2083].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[60].goal.getItem[1].id) >= qt[60].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[60].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[167].goal.getItem[1].id) >= qt[167].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[167].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[173].goal.getItem[1].id) >= qt[173].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[173].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[179].goal.getItem[1].id) >= qt[179].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[179].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[383].goal.getItem[1].id) >= qt[383].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[383].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[633].goal.getItem[1].id) >= qt[633].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[633].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[634].goal.getItem[1].id) >= qt[634].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[634].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2090].goal.getItem[1].id) >= qt[2090].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2090].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1127].goal.getItem[1].id) >= qt[1127].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1127].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1128].goal.getItem[1].id) >= qt[1128].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1128].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1146].goal.getItem[1].id) >= qt[1146].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1146].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1178].goal.getItem[1].id) >= qt[1178].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1178].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1399].goal.getItem[1].id) >= qt[1399].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1399].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[60].goal.getItem[1].id) >= qt[60].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[60].goal.getItem) then
-         if CHECK_ITEM_CNT(qt[118].goal.getItem[1].id) >= qt[118].goal.getItem[1].count and CHECK_ITEM_CNT(qt[118].goal.getItem[2].id) >= qt[118].goal.getItem[2].count then
+         if __QUEST_HAS_ALL_ITEMS(qt[118].goal.getItem) then
-         if CHECK_ITEM_CNT(qt[119].goal.getItem[1].id) >= qt[119].goal.getItem[1].count and CHECK_ITEM_CNT(qt[119].goal.getItem[2].id) >= qt[119].goal.getItem[2].count then
+         if __QUEST_HAS_ALL_ITEMS(qt[119].goal.getItem) then
-         if CHECK_ITEM_CNT(qt[120].goal.getItem[1].id) >= qt[120].goal.getItem[1].count and CHECK_ITEM_CNT(qt[120].goal.getItem[2].id) >= qt[120].goal.getItem[2].count then
+         if __QUEST_HAS_ALL_ITEMS(qt[120].goal.getItem) then
-         if CHECK_ITEM_CNT(qt[381].goal.getItem[1].id) >= qt[381].goal.getItem[1].count and CHECK_ITEM_CNT(qt[381].goal.getItem[2].id) >= qt[381].goal.getItem[2].count then
+         if __QUEST_HAS_ALL_ITEMS(qt[381].goal.getItem) then
-         if CHECK_ITEM_CNT(qt[627].goal.getItem[1].id) >= qt[627].goal.getItem[1].count and CHECK_ITEM_CNT(qt[627].goal.getItem[2].id) >= qt[627].goal.getItem[2].count then
+         if __QUEST_HAS_ALL_ITEMS(qt[627].goal.getItem) then
-         if CHECK_ITEM_CNT(qt[2083].goal.getItem[1].id) >= qt[2083].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2083].goal.getItem[2].id) >= qt[2083].goal.getItem[2].count then
+         if __QUEST_HAS_ALL_ITEMS(qt[2083].goal.getItem) then
-           if CHECK_ITEM_CNT(qt[167].goal.getItem[1].id) >= qt[167].goal.getItem[1].count then
+           if __QUEST_HAS_ALL_ITEMS(qt[167].goal.getItem) then
-           if CHECK_ITEM_CNT(qt[173].goal.getItem[1].id) >= qt[173].goal.getItem[1].count then
+           if __QUEST_HAS_ALL_ITEMS(qt[173].goal.getItem) then
-           if CHECK_ITEM_CNT(qt[179].goal.getItem[1].id) >= qt[179].goal.getItem[1].count then
+           if __QUEST_HAS_ALL_ITEMS(qt[179].goal.getItem) then
-           if CHECK_ITEM_CNT(qt[383].goal.getItem[1].id) >= qt[383].goal.getItem[1].count then
+           if __QUEST_HAS_ALL_ITEMS(qt[383].goal.getItem) then
-           if CHECK_ITEM_CNT(qt[633].goal.getItem[1].id) >= qt[633].goal.getItem[1].count then
+           if __QUEST_HAS_ALL_ITEMS(qt[633].goal.getItem) then
-           if CHECK_ITEM_CNT(qt[634].goal.getItem[1].id) >= qt[634].goal.getItem[1].count then
+           if __QUEST_HAS_ALL_ITEMS(qt[634].goal.getItem) then
-           if CHECK_ITEM_CNT(qt[2090].goal.getItem[1].id) >= qt[2090].goal.getItem[1].count then
+           if __QUEST_HAS_ALL_ITEMS(qt[2090].goal.getItem) then
-           if CHECK_ITEM_CNT(qt[2091].goal.getItem[1].id) >= qt[2091].goal.getItem[1].count then
+           if __QUEST_HAS_ALL_ITEMS(qt[2091].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1127].goal.getItem[1].id) >= qt[1127].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1127].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1146].goal.getItem[1].id) >= qt[1146].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1146].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1178].goal.getItem[1].id) >= qt[1178].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1178].goal.getItem) then

--- npc_314035.lua
+++ npc_314035_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2126].goal.getItem[1].id) >= qt[2126].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2126].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2127].goal.getItem[1].id) >= qt[2127].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2127].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2128].goal.getItem[1].id) >= qt[2128].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2128].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2135].goal.getItem[1].id) >= qt[2135].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2135].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2126].goal.getItem[1].id) >= qt[2126].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2126].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2127].goal.getItem[1].id) >= qt[2127].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2127].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2128].goal.getItem[1].id) >= qt[2128].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2128].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2135].goal.getItem[1].id) >= qt[2135].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2135].goal.getItem) then

--- npc_314036.lua
+++ npc_314036_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2119].goal.getItem[1].id) >= qt[2119].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2119].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2120].goal.getItem[1].id) >= qt[2120].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2120].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2121].goal.getItem[1].id) >= qt[2121].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2121].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2134].goal.getItem[1].id) >= qt[2134].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2134].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2119].goal.getItem[1].id) >= qt[2119].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2119].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2120].goal.getItem[1].id) >= qt[2120].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2120].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2121].goal.getItem[1].id) >= qt[2121].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2121].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2134].goal.getItem[1].id) >= qt[2134].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2134].goal.getItem) then

--- npc_314058.lua
+++ npc_314058_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if qData[1101].meetNpc[1] == qt[1101].goal.meetNpc[1] and CHECK_ITEM_CNT(qt[1101].goal.getItem[1].id) >= qt[1101].goal.getItem[1].count then
+     if qData[1101].meetNpc[1] == qt[1101].goal.meetNpc[1] and __QUEST_HAS_ALL_ITEMS(qt[1101].goal.getItem) then
-       if qData[1101].meetNpc[1] == qt[1101].goal.meetNpc[1] and CHECK_ITEM_CNT(qt[1101].goal.getItem[1].id) >= qt[1101].goal.getItem[1].count then
+       if qData[1101].meetNpc[1] == qt[1101].goal.meetNpc[1] and __QUEST_HAS_ALL_ITEMS(qt[1101].goal.getItem) then

--- npc_314059.lua
+++ npc_314059_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1111].goal.getItem[1].id) >= qt[1111].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1111].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1111].goal.getItem[1].id) >= qt[1111].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1111].goal.getItem) then

--- npc_314060.lua
+++ npc_314060_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1110].goal.getItem[1].id) >= qt[1110].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1110].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1110].goal.getItem[1].id) >= qt[1110].goal.getItem[1].id then
+       if CHECK_ITEM_CNT(__QUEST_FIRST_ITEM_ID(qt[1110].goal.getItem)) >= __QUEST_FIRST_ITEM_ID(qt[1110].goal.getItem) then

--- npc_314061.lua
+++ npc_314061_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1109].goal.getItem[1].id) >= qt[1109].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1109].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1109].goal.getItem[1].id) >= qt[1109].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1109].goal.getItem) then

--- npc_314062.lua
+++ npc_314062_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if qData[2034].killMonster[qt[2034].goal.killMonster[1].id] >= qt[2034].goal.killMonster[1].count and CHECK_ITEM_CNT(qt[2034].goal.getItem[1].id) >= qt[2034].goal.getItem[1].count then
+     if qData[2034].killMonster[qt[2034].goal.killMonster[1].id] >= qt[2034].goal.killMonster[1].count and __QUEST_HAS_ALL_ITEMS(qt[2034].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2039].goal.getItem[1].id) >= qt[2039].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2039].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2040].goal.getItem[1].id) >= qt[2040].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2040].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2041].goal.getItem[1].id) >= qt[2041].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2041].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2042].goal.getItem[1].id) >= qt[2042].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2042].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2046].goal.getItem[1].id) >= qt[2046].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2046].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2047].goal.getItem[1].id) >= qt[2047].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2047].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2048].goal.getItem[1].id) >= qt[2048].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2048].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2049].goal.getItem[1].id) >= qt[2049].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2049].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2055].goal.getItem[1].id) >= qt[2055].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2055].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2061].goal.getItem[1].id) >= qt[2061].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2061].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2062].goal.getItem[1].id) >= qt[2062].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2062].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2063].goal.getItem[1].id) >= qt[2063].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2063].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2071].goal.getItem[1].id) >= qt[2071].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2071].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2072].goal.getItem[1].id) >= qt[2072].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2072].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2156].goal.getItem[1].id) >= qt[2156].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2156].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2157].goal.getItem[1].id) >= qt[2157].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2157].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2158].goal.getItem[1].id) >= qt[2158].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2158].goal.getItem) then
-       if qData[2034].killMonster[qt[2034].goal.killMonster[1].id] >= qt[2034].goal.killMonster[1].count and CHECK_ITEM_CNT(qt[2034].goal.getItem[1].id) >= qt[2034].goal.getItem[1].count then
+       if qData[2034].killMonster[qt[2034].goal.killMonster[1].id] >= qt[2034].goal.killMonster[1].count and __QUEST_HAS_ALL_ITEMS(qt[2034].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2039].goal.getItem[1].id) >= qt[2039].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2039].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2040].goal.getItem[1].id) >= qt[2040].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2040].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2041].goal.getItem[1].id) >= qt[2041].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2041].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2042].goal.getItem[1].id) >= qt[2042].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2042].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2046].goal.getItem[1].id) >= qt[2046].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2046].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2047].goal.getItem[1].id) >= qt[2047].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2047].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2048].goal.getItem[1].id) >= qt[2048].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2048].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2049].goal.getItem[1].id) >= qt[2049].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2049].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2055].goal.getItem[1].id) >= qt[2055].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2055].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2061].goal.getItem[1].id) >= qt[2061].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2061].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2062].goal.getItem[1].id) >= qt[2062].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2062].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2063].goal.getItem[1].id) >= qt[2063].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2063].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2071].goal.getItem[1].id) >= qt[2071].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2071].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2072].goal.getItem[1].id) >= qt[2072].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2072].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2156].goal.getItem[1].id) >= qt[2156].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2156].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2157].goal.getItem[1].id) >= qt[2157].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2157].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2158].goal.getItem[1].id) >= qt[2158].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2158].goal.getItem) then

--- npc_315002.lua
+++ npc_315002_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[163].goal.getItem[1].id) >= qt[163].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[163].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1279].goal.getItem[1].id) >= qt[1279].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1279].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1299].goal.getItem[1].id) >= qt[1299].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1299].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1300].goal.getItem[1].id) >= qt[1300].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1300].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1314].goal.getItem[1].id) >= qt[1314].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1314].goal.getItem[2].id) >= qt[1314].goal.getItem[2].count and CHECK_ITEM_CNT(qt[1314].goal.getItem[3].id) >= qt[1314].goal.getItem[3].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1314].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1279].goal.getItem[1].id) >= qt[1279].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1279].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1299].goal.getItem[1].id) >= qt[1299].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1299].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1300].goal.getItem[1].id) >= qt[1300].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1300].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1314].goal.getItem[1].id) >= qt[1314].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1314].goal.getItem[2].id) >= qt[1314].goal.getItem[2].count and CHECK_ITEM_CNT(qt[1314].goal.getItem[3].id) >= qt[1314].goal.getItem[3].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1314].goal.getItem) then

--- npc_315006.lua
+++ npc_315006_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[157].goal.getItem[1].id) >= qt[157].goal.getItem[1].count and CHECK_ITEM_CNT(qt[157].goal.getItem[2].id) >= qt[157].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[157].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[161].goal.getItem[1].id) >= qt[161].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[161].goal.getItem) then

--- npc_315007.lua
+++ npc_315007_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[235].goal.getItem[1].id) >= qt[235].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[235].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[240].goal.getItem[1].id) >= qt[240].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[240].goal.getItem) then
-   if qData[244].state == 1 and qData[242].state == 2 and CHECK_ITEM_CNT(qt[244].goal.getItem[1].id) >= qt[244].goal.getItem[1].count then
+   if qData[244].state == 1 and qData[242].state == 2 and __QUEST_HAS_ALL_ITEMS(qt[244].goal.getItem) then
-   if qData[473].state == 1 and CHECK_ITEM_CNT(qt[473].goal.getItem[1].id) >= qt[473].goal.getItem[1].count then
+   if qData[473].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[473].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1071].goal.getItem[1].id) >= qt[1071].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1071].goal.getItem[2].id) >= qt[1071].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1071].goal.getItem) then
-   if qData[1252].state == 1 and CHECK_ITEM_CNT(qt[1252].goal.getItem[1].id) >= qt[1252].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1252].goal.getItem[2].id) >= qt[1252].goal.getItem[2].count then
+   if qData[1252].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1252].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[244].goal.getItem[1].id) >= qt[244].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[244].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[473].goal.getItem[1].id) >= qt[473].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[473].goal.getItem) then
-   if qData[1252].state == 1 and CHECK_ITEM_CNT(qt[1252].goal.getItem[1].id) >= qt[1252].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1252].goal.getItem[2].id) >= qt[1252].goal.getItem[2].count then
+   if qData[1252].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1252].goal.getItem) then

--- npc_315009.lua
+++ npc_315009_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[166].goal.getItem[1].id) >= qt[166].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[166].goal.getItem) then

--- npc_315010.lua
+++ npc_315010_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     elseif CHECK_ITEM_CNT(qt[111].goal.getItem[1].id) >= qt[111].goal.getItem[1].count then
+     elseif __QUEST_HAS_ALL_ITEMS(qt[111].goal.getItem) then
-   if qData[1246].state == 1 and CHECK_ITEM_CNT(qt[1246].goal.getItem[1].id) >= qt[1246].goal.getItem[1].count then
+   if qData[1246].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1246].goal.getItem) then
-   if qData[1246].state == 1 and CHECK_ITEM_CNT(qt[1246].goal.getItem[1].id) >= qt[1246].goal.getItem[1].count then
+   if qData[1246].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1246].goal.getItem) then

--- npc_315011.lua
+++ npc_315011_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[121].goal.getItem[1].id) >= qt[121].goal.getItem[1].count and CHECK_ITEM_CNT(qt[121].goal.getItem[2].id) >= qt[121].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[121].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[126].goal.getItem[1].id) >= qt[126].goal.getItem[1].count and CHECK_ITEM_CNT(qt[126].goal.getItem[2].id) >= qt[126].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[126].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1257].goal.getItem[1].id) >= qt[1257].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1257].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1258].goal.getItem[1].id) >= qt[1258].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1258].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1259].goal.getItem[1].id) >= qt[1259].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1259].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1260].goal.getItem[1].id) >= qt[1260].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1260].goal.getItem[2].id) >= qt[1260].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1260].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1261].goal.getItem[1].id) >= qt[1261].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1261].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[121].goal.getItem[1].id) >= qt[121].goal.getItem[1].count and CHECK_ITEM_CNT(qt[121].goal.getItem[2].id) >= qt[121].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[121].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[126].goal.getItem[1].id) >= qt[126].goal.getItem[1].count and CHECK_ITEM_CNT(qt[126].goal.getItem[2].id) >= qt[126].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[126].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1261].goal.getItem[1].id) >= qt[1261].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1261].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1257].goal.getItem[1].id) >= qt[1257].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1257].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1258].goal.getItem[1].id) >= qt[1258].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1258].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1259].goal.getItem[1].id) >= qt[1259].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1259].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1260].goal.getItem[1].id) >= qt[1260].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1260].goal.getItem[2].id) >= qt[1260].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1260].goal.getItem) then

--- npc_315015.lua
+++ npc_315015_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if qData[144].meetNpc[1] == qt[144].goal.meetNpc[1] and CHECK_ITEM_CNT(qt[144].goal.getItem[1].id) >= qt[144].goal.getItem[1].count then
+     if qData[144].meetNpc[1] == qt[144].goal.meetNpc[1] and __QUEST_HAS_ALL_ITEMS(qt[144].goal.getItem) then
-       if qData[144].meetNpc[1] == qt[144].goal.meetNpc[1] and CHECK_ITEM_CNT(qt[144].goal.getItem[1].id) >= qt[144].goal.getItem[1].count then
+       if qData[144].meetNpc[1] == qt[144].goal.meetNpc[1] and __QUEST_HAS_ALL_ITEMS(qt[144].goal.getItem) then

--- npc_315018.lua
+++ npc_315018_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1270].goal.getItem[1].id) >= qt[1270].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1270].goal.getItem) then
-   if qData[1043].state == 1 and CHECK_ITEM_CNT(qt[1043].goal.getItem[1].id) >= qt[1043].goal.getItem[1].count then
+   if qData[1043].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1043].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1271].goal.getItem[1].id) >= qt[1271].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1271].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1043].goal.getItem[1].id) >= qt[1043].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1043].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1270].goal.getItem[1].id) >= qt[1270].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1270].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1271].goal.getItem[1].id) >= qt[1271].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1271].goal.getItem) then

--- npc_315019.lua
+++ npc_315019_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-   if qData[1008].state == 1 and CHECK_ITEM_CNT(qt[1008].goal.getItem[1].id) >= qt[1008].goal.getItem[1].count then
+   if qData[1008].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1008].goal.getItem) then
-   if qData[1289].state == 1 and CHECK_ITEM_CNT(qt[1289].goal.getItem[1].id) >= qt[1289].goal.getItem[1].count then
+   if qData[1289].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1289].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1008].goal.getItem[1].id) >= qt[1008].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1008].goal.getItem) then

--- npc_315020.lua
+++ npc_315020_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-   if qData[1006].state == 1 and CHECK_ITEM_CNT(qt[1006].goal.getItem[1].id) >= qt[1006].goal.getItem[1].count then
+   if qData[1006].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1006].goal.getItem) then
-   if qData[1230].state == 1 and CHECK_ITEM_CNT(qt[1230].goal.getItem[1].id) >= qt[1230].goal.getItem[1].count then
+   if qData[1230].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1230].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1006].goal.getItem[1].id) >= qt[1006].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1006].goal.getItem) then

--- npc_315024.lua
+++ npc_315024_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-   if qData[1254].state == 1 and CHECK_ITEM_CNT(qt[1254].goal.getItem[1].id) >= qt[1254].goal.getItem[1].count then
+   if qData[1254].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1254].goal.getItem) then
-   if qData[1254].state ~= 2 and qData[1240].state == 2 and GET_PLAYER_LEVEL() >= qt[1254].needLevel and qData[1254].state == 1 and CHECK_ITEM_CNT(qt[1254].goal.getItem[1].id) >= qt[1254].goal.getItem[1].count then
+   if qData[1254].state ~= 2 and qData[1240].state == 2 and GET_PLAYER_LEVEL() >= qt[1254].needLevel and qData[1254].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1254].goal.getItem) then

--- npc_315025.lua
+++ npc_315025_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1348].goal.getItem[1].id) >= qt[1348].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1348].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1349].goal.getItem[1].id) >= qt[1349].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1349].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1350].goal.getItem[1].id) >= qt[1350].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1350].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1351].goal.getItem[1].id) >= qt[1351].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1351].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1352].goal.getItem[1].id) >= qt[1352].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1352].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1353].goal.getItem[1].id) >= qt[1353].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1353].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1354].goal.getItem[1].id) >= qt[1354].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1354].goal.getItem[2].id) >= qt[1354].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1354].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1355].goal.getItem[1].id) >= qt[1355].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1355].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1356].goal.getItem[1].id) >= qt[1356].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1356].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1358].goal.getItem[1].id) >= qt[1358].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1358].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1359].goal.getItem[1].id) >= qt[1359].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1359].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1360].goal.getItem[1].id) >= qt[1360].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1360].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1362].goal.getItem[1].id) >= qt[1362].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1362].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1363].goal.getItem[1].id) >= qt[1363].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1363].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1364].goal.getItem[1].id) >= qt[1364].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1364].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1365].goal.getItem[1].id) >= qt[1365].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1365].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1366].goal.getItem[1].id) >= qt[1366].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1366].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1368].goal.getItem[1].id) >= qt[1368].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1368].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1369].goal.getItem[1].id) >= qt[1369].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1369].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1370].goal.getItem[1].id) >= qt[1370].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1370].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1373].goal.getItem[1].id) >= qt[1373].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1373].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1374].goal.getItem[1].id) >= qt[1374].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1374].goal.getItem[2].id) >= qt[1374].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1374].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1375].goal.getItem[1].id) >= qt[1375].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1375].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1376].goal.getItem[1].id) >= qt[1376].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1376].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1377].goal.getItem[1].id) >= qt[1377].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1377].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1378].goal.getItem[1].id) >= qt[1378].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1378].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1382].goal.getItem[1].id) >= qt[1382].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1382].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1383].goal.getItem[1].id) >= qt[1383].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1383].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1384].goal.getItem[1].id) >= qt[1384].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1384].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1385].goal.getItem[1].id) >= qt[1385].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1385].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1389].goal.getItem[1].id) >= qt[1389].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1389].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[867].goal.getItem[1].id) >= qt[867].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[867].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1348].goal.getItem[1].id) >= qt[1348].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1348].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1349].goal.getItem[1].id) >= qt[1349].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1349].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1350].goal.getItem[1].id) >= qt[1350].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1350].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1351].goal.getItem[1].id) >= qt[1351].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1351].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1352].goal.getItem[1].id) >= qt[1352].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1352].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1353].goal.getItem[1].id) >= qt[1353].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1353].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1354].goal.getItem[1].id) >= qt[1354].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1354].goal.getItem[2].id) >= qt[1354].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1354].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1355].goal.getItem[1].id) >= qt[1355].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1355].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1356].goal.getItem[1].id) >= qt[1356].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1356].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1358].goal.getItem[1].id) >= qt[1358].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1358].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1359].goal.getItem[1].id) >= qt[1359].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1359].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1360].goal.getItem[1].id) >= qt[1360].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1360].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1362].goal.getItem[1].id) >= qt[1362].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1362].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1363].goal.getItem[1].id) >= qt[1363].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1363].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1364].goal.getItem[1].id) >= qt[1364].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1364].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1365].goal.getItem[1].id) >= qt[1365].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1365].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1366].goal.getItem[1].id) >= qt[1366].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1366].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1368].goal.getItem[1].id) >= qt[1368].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1368].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1369].goal.getItem[1].id) >= qt[1369].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1369].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1370].goal.getItem[1].id) >= qt[1370].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1370].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1373].goal.getItem[1].id) >= qt[1373].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1373].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1374].goal.getItem[1].id) >= qt[1374].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1374].goal.getItem[2].id) >= qt[1374].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1374].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1375].goal.getItem[1].id) >= qt[1375].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1375].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1376].goal.getItem[1].id) >= qt[1376].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1376].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1377].goal.getItem[1].id) >= qt[1377].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1377].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1378].goal.getItem[1].id) >= qt[1378].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1378].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1382].goal.getItem[1].id) >= qt[1382].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1382].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1383].goal.getItem[1].id) >= qt[1383].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1383].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1384].goal.getItem[1].id) >= qt[1384].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1384].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1385].goal.getItem[1].id) >= qt[1385].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1385].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1389].goal.getItem[1].id) >= qt[1389].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1389].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[867].goal.getItem[1].id) >= qt[867].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[867].goal.getItem) then

--- npc_316003.lua
+++ npc_316003_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1542].goal.getItem[1].id) >= qt[1542].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1542].goal.getItem[2].id) >= qt[1542].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1542].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1552].goal.getItem[1].id) >= qt[1552].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1552].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1548].goal.getItem[1].id) >= qt[1548].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1548].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[284].goal.getItem[1].id) >= qt[284].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[284].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[285].goal.getItem[1].id) >= qt[285].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[285].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1542].goal.getItem[1].id) >= qt[1542].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1542].goal.getItem[2].id) >= qt[1542].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1542].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[284].goal.getItem[1].id) >= qt[284].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[284].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[285].goal.getItem[1].id) >= qt[285].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[285].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1552].goal.getItem[1].id) >= qt[1552].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1552].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1548].goal.getItem[1].id) >= qt[1548].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1548].goal.getItem) then

--- npc_316004.lua
+++ npc_316004_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1558].goal.getItem[1].id) >= qt[1558].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1558].goal.getItem[2].id) >= qt[1558].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1558].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1546].goal.getItem[1].id) >= qt[1546].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1546].goal.getItem) then
-   if qData[480].state == 2 and qData[481].state == 1 and CHECK_ITEM_CNT(qt[481].goal.getItem[1].id) >= qt[481].goal.getItem[1].count then
+   if qData[480].state == 2 and qData[481].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[481].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1558].goal.getItem[1].id) >= qt[1558].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1558].goal.getItem[2].id) >= qt[1558].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1558].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1546].goal.getItem[1].id) >= qt[1546].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1546].goal.getItem) then

--- npc_316005.lua
+++ npc_316005_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1557].goal.getItem[1].id) >= qt[1557].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1557].goal.getItem[2].id) >= qt[1557].goal.getItem[2].count and qData[1557].killMonster[qt[1557].goal.killMonster[1].id] >= qt[1557].goal.killMonster[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1557].goal.getItem) and qData[1557].killMonster[qt[1557].goal.killMonster[1].id] >= qt[1557].goal.killMonster[1].count then
-       if CHECK_ITEM_CNT(qt[1557].goal.getItem[1].id) >= qt[1557].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1557].goal.getItem[2].id) >= qt[1557].goal.getItem[2].count and qData[1557].killMonster[qt[1557].goal.killMonster[1].id] >= qt[1557].goal.killMonster[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1557].goal.getItem) and qData[1557].killMonster[qt[1557].goal.killMonster[1].id] >= qt[1557].goal.killMonster[1].count then

--- npc_316006.lua
+++ npc_316006_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1560].goal.getItem[1].id) >= qt[1560].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1560].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[286].goal.getItem[1].id) >= qt[286].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[286].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[290].goal.getItem[1].id) >= qt[290].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[290].goal.getItem) then
-     if qData[288].killMonster[qt[288].goal.killMonster[1].id] >= qt[288].goal.killMonster[1].count and CHECK_ITEM_CNT(qt[288].goal.getItem[1].id) >= qt[288].goal.getItem[1].count then
+     if qData[288].killMonster[qt[288].goal.killMonster[1].id] >= qt[288].goal.killMonster[1].count and __QUEST_HAS_ALL_ITEMS(qt[288].goal.getItem) then
-       if qData[483].meetNpc[3] ~= id and CHECK_ITEM_CNT(qt[483].goal.getItem[1].id) >= qt[483].goal.getItem[1].count then
+       if qData[483].meetNpc[3] ~= id and __QUEST_HAS_ALL_ITEMS(qt[483].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1560].goal.getItem[1].id) >= qt[1560].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1560].goal.getItem) then

--- npc_316008.lua
+++ npc_316008_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[292].goal.getItem[1].id) >= qt[292].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[292].goal.getItem) then

--- npc_316009.lua
+++ npc_316009_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[485].goal.getItem[1].id) >= qt[485].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[485].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[486].goal.getItem[1].id) >= qt[486].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[486].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[487].goal.getItem[1].id) >= qt[487].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[487].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[491].goal.getItem[1].id) >= qt[491].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[491].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[492].goal.getItem[1].id) >= qt[492].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[492].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2161].goal.getItem[1].id) >= qt[2161].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2161].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[497].goal.getItem[1].id) >= qt[497].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[497].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[714].goal.getItem[1].id) >= qt[714].goal.getItem[1].count and CHECK_ITEM_CNT(qt[714].goal.getItem[2].id) >= qt[714].goal.getItem[2].count and CHECK_ITEM_CNT(qt[714].goal.getItem[3].id) >= qt[714].goal.getItem[3].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[714].goal.getItem) then
-   if qData[720].state == 1 and CHECK_ITEM_CNT(qt[720].goal.getItem[1].id) >= qt[720].goal.getItem[1].count then
+   if qData[720].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[720].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[721].goal.getItem[1].id) >= qt[721].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[721].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[722].goal.getItem[1].id) >= qt[722].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[722].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1010].goal.getItem[1].id) >= qt[1010].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1010].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2130].goal.getItem[1].id) >= qt[2130].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2130].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[485].goal.getItem[1].id) >= qt[485].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[485].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[486].goal.getItem[1].id) >= qt[486].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[486].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[487].goal.getItem[1].id) >= qt[487].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[487].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[491].goal.getItem[1].id) >= qt[491].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[491].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[492].goal.getItem[1].id) >= qt[492].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[492].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[497].goal.getItem[1].id) >= qt[497].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[497].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[714].goal.getItem[1].id) >= qt[714].goal.getItem[1].count and CHECK_ITEM_CNT(qt[714].goal.getItem[2].id) >= qt[714].goal.getItem[2].count and CHECK_ITEM_CNT(qt[714].goal.getItem[3].id) >= qt[714].goal.getItem[3].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[714].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[721].goal.getItem[1].id) >= qt[721].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[721].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[722].goal.getItem[1].id) >= qt[722].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[722].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1010].goal.getItem[1].id) >= qt[1010].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1010].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2130].goal.getItem[1].id) >= qt[2130].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2130].goal.getItem) then

--- npc_316010.lua
+++ npc_316010_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[534].goal.getItem[1].id) >= qt[534].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[534].goal.getItem) then
-         if CHECK_ITEM_CNT(qt[534].goal.getItem[1].id) >= qt[534].goal.getItem[1].count then
+         if __QUEST_HAS_ALL_ITEMS(qt[534].goal.getItem) then

--- npc_316013.lua
+++ npc_316013_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2379].goal.getItem[1].id) >= qt[2379].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2379].goal.getItem) then
-   if qData[2420].state == 1 and CHECK_ITEM_CNT(qt[2420].goal.getItem[1].id) >= qt[2420].goal.getItem[1].count then
+   if qData[2420].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[2420].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2421].goal.getItem[1].id) >= qt[2421].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2421].goal.getItem) then
-   if qData[2423].state == 1 and CHECK_ITEM_CNT(qt[2423].goal.getItem[1].id) >= qt[2423].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2423].goal.getItem[2].id) >= qt[2423].goal.getItem[2].count then
+   if qData[2423].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[2423].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2425].goal.getItem[1].id) >= qt[2425].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2425].goal.getItem[2].id) >= qt[2425].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2425].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2442].goal.getItem[1].id) >= qt[2442].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2442].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2443].goal.getItem[1].id) >= qt[2443].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2443].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2444].goal.getItem[1].id) >= qt[2444].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2444].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2452].goal.getItem[1].id) >= qt[2452].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2452].goal.getItem[2].id) >= qt[2452].goal.getItem[2].count and CHECK_ITEM_CNT(qt[2452].goal.getItem[3].id) >= qt[2452].goal.getItem[3].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2452].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2453].goal.getItem[1].id) >= qt[2453].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2453].goal.getItem[2].id) >= qt[2453].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2453].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2454].goal.getItem[1].id) >= qt[2454].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2454].goal.getItem[2].id) >= qt[2454].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2454].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[3664].goal.getItem[1].id) >= qt[3664].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3664].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[3665].goal.getItem[1].id) >= qt[3665].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3665].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3664].goal.getItem[1].id) >= qt[3664].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3664].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3665].goal.getItem[1].id) >= qt[3665].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3665].goal.getItem) then

--- npc_317001.lua
+++ npc_317001_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1167].goal.getItem[1].id) >= qt[1167].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1167].goal.getItem[2].id) >= qt[1167].goal.getItem[2].count and CHECK_ITEM_CNT(qt[1167].goal.getItem[3].id) >= qt[1167].goal.getItem[3].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1167].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1172].goal.getItem[1].id) >= qt[1172].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1172].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1167].goal.getItem[1].id) >= qt[1167].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1167].goal.getItem[2].id) >= qt[1167].goal.getItem[2].count and CHECK_ITEM_CNT(qt[1167].goal.getItem[3].id) >= qt[1167].goal.getItem[3].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1167].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1172].goal.getItem[1].id) >= qt[1172].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1172].goal.getItem) then

--- npc_317002.lua
+++ npc_317002_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1157].goal.getItem[1].id) >= qt[1157].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1157].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1157].goal.getItem[1].id) >= qt[1157].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1157].goal.getItem) then

--- npc_317003.lua
+++ npc_317003_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[333].goal.getItem[1].id) >= qt[333].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[333].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1170].goal.getItem[1].id) >= qt[1170].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1170].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1170].goal.getItem[1].id) >= qt[1170].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1170].goal.getItem) then

--- npc_317004.lua
+++ npc_317004_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1138].goal.getItem[1].id) >= qt[1138].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1138].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1160].goal.getItem[1].id) >= qt[1160].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1160].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1166].goal.getItem[1].id) >= qt[1166].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1166].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1173].goal.getItem[1].id) >= qt[1173].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1173].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1175].goal.getItem[1].id) >= qt[1175].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1175].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1138].goal.getItem[1].id) >= qt[1138].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1138].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1160].goal.getItem[1].id) >= qt[1160].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1160].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1166].goal.getItem[1].id) >= qt[1166].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1166].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1173].goal.getItem[1].id) >= qt[1173].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1173].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1175].goal.getItem[1].id) >= qt[1175].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1175].goal.getItem) then

--- npc_317006.lua
+++ npc_317006_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[329].goal.getItem[1].id) >= qt[329].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[329].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1161].goal.getItem[1].id) >= qt[1161].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1161].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1168].goal.getItem[1].id) >= qt[1168].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1168].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1161].goal.getItem[1].id) >= qt[1161].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1161].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1168].goal.getItem[1].id) >= qt[1168].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1168].goal.getItem) then

--- npc_317007.lua
+++ npc_317007_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[330].goal.getItem[1].id) >= qt[330].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[330].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1164].goal.getItem[1].id) >= qt[1164].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1164].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1171].goal.getItem[1].id) >= qt[1171].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1171].goal.getItem[2].id) >= qt[1171].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1171].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1164].goal.getItem[1].id) >= qt[1164].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1164].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1171].goal.getItem[1].id) >= qt[1171].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1171].goal.getItem[2].id) >= qt[1171].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1171].goal.getItem) then

--- npc_318001.lua
+++ npc_318001_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[3659].goal.getItem[1].id) >= qt[3659].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3659].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[3660].goal.getItem[1].id) >= qt[3660].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3660].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[3661].goal.getItem[1].id) >= qt[3661].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3661].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3659].goal.getItem[1].id) >= qt[3659].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3659].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3660].goal.getItem[1].id) >= qt[3660].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3660].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3661].goal.getItem[1].id) >= qt[3661].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3661].goal.getItem) then

--- npc_318003.lua
+++ npc_318003_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[579].goal.getItem[1].id) >= qt[579].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[579].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[605].goal.getItem[1].id) >= qt[605].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[605].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[579].goal.getItem[1].id) >= qt[579].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[579].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[605].goal.getItem[1].id) >= qt[605].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[605].goal.getItem) then

--- npc_318006.lua
+++ npc_318006_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-   if qData[1290].state == 1 and CHECK_ITEM_CNT(qt[1290].goal.getItem[1].id) >= qt[1290].goal.getItem[1].count then
+   if qData[1290].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1290].goal.getItem) then

--- npc_318013.lua
+++ npc_318013_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1292].goal.getItem[1].id) >= qt[1292].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1292].goal.getItem[2].id) >= qt[1292].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1292].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1380].goal.getItem[1].id) >= qt[1380].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1380].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1292].goal.getItem[1].id) >= qt[1292].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1292].goal.getItem[2].id) >= qt[1292].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1292].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1380].goal.getItem[1].id) >= qt[1380].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1380].goal.getItem) then

--- npc_318020.lua
+++ npc_318020_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[568].goal.getItem[1].id) >= qt[568].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[568].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[569].goal.getItem[1].id) >= qt[569].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[569].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[570].goal.getItem[1].id) >= qt[570].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[570].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[573].goal.getItem[1].id) >= qt[573].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[573].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[575].goal.getItem[1].id) >= qt[575].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[575].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[576].goal.getItem[1].id) >= qt[576].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[576].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[579].goal.getItem[1].id) >= qt[579].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[579].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[580].goal.getItem[1].id) >= qt[580].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[580].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[581].goal.getItem[1].id) >= qt[581].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[581].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[582].goal.getItem[1].id) >= qt[582].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[582].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[583].goal.getItem[1].id) >= qt[583].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[583].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[584].goal.getItem[1].id) >= qt[584].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[584].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[586].goal.getItem[1].id) >= qt[586].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[586].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[589].goal.getItem[1].id) >= qt[589].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[589].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[590].goal.getItem[1].id) >= qt[590].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[590].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[591].goal.getItem[1].id) >= qt[591].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[591].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[592].goal.getItem[1].id) >= qt[592].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[592].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[593].goal.getItem[1].id) >= qt[593].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[593].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[599].goal.getItem[1].id) >= qt[599].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[599].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[600].goal.getItem[1].id) >= qt[600].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[600].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[603].goal.getItem[1].id) >= qt[603].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[603].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[605].goal.getItem[1].id) >= qt[605].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[605].goal.getItem) then

--- npc_318021.lua
+++ npc_318021_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[771].goal.getItem[1].id) >= qt[771].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[771].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[771].goal.getItem[1].id) >= qt[771].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[771].goal.getItem) then

--- npc_318022.lua
+++ npc_318022_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[776].goal.getItem[1].id) >= qt[776].goal.getItem[1].count and CHECK_ITEM_CNT(qt[776].goal.getItem[2].id) >= qt[776].goal.getItem[2].count and CHECK_ITEM_CNT(qt[776].goal.getItem[3].id) >= qt[776].goal.getItem[3].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[776].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[776].goal.getItem[1].id) >= qt[776].goal.getItem[1].count and CHECK_ITEM_CNT(qt[776].goal.getItem[2].id) >= qt[776].goal.getItem[2].count and CHECK_ITEM_CNT(qt[776].goal.getItem[3].id) >= qt[776].goal.getItem[3].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[776].goal.getItem) then

--- npc_318023.lua
+++ npc_318023_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[779].goal.getItem[1].id) >= qt[779].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[779].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[781].goal.getItem[1].id) >= qt[781].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[781].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[783].goal.getItem[1].id) >= qt[783].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[783].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[785].goal.getItem[1].id) >= qt[785].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[785].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[787].goal.getItem[1].id) >= qt[787].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[787].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[789].goal.getItem[1].id) >= qt[789].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[789].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[779].goal.getItem[1].id) >= qt[779].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[779].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[781].goal.getItem[1].id) >= qt[781].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[781].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[783].goal.getItem[1].id) >= qt[783].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[783].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[785].goal.getItem[1].id) >= qt[785].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[785].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[787].goal.getItem[1].id) >= qt[787].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[787].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[789].goal.getItem[1].id) >= qt[789].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[789].goal.getItem) then

--- npc_318024.lua
+++ npc_318024_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[791].goal.getItem[1].id) >= qt[791].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[791].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[793].goal.getItem[1].id) >= qt[793].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[793].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[794].goal.getItem[1].id) >= qt[794].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[794].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[795].goal.getItem[1].id) >= qt[795].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[795].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[791].goal.getItem[1].id) >= qt[791].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[791].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[793].goal.getItem[1].id) >= qt[793].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[793].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[794].goal.getItem[1].id) >= qt[794].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[794].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[795].goal.getItem[1].id) >= qt[795].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[795].goal.getItem) then

--- npc_319006.lua
+++ npc_319006_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1408].goal.getItem[1].id) >= qt[1408].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1408].goal.getItem[2].id) >= qt[1408].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1408].goal.getItem) then

--- npc_320001.lua
+++ npc_320001_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1016].goal.getItem[1].id) >= qt[1016].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1016].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1017].goal.getItem[1].id) >= qt[1017].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1017].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1018].goal.getItem[1].id) >= qt[1018].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1018].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2467].goal.getItem[1].id) >= qt[2467].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2467].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2566].goal.getItem[1].id) >= qt[2566].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2566].goal.getItem[2].id) >= qt[2566].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2566].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2567].goal.getItem[1].id) >= qt[2567].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2567].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2568].goal.getItem[1].id) >= qt[2568].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2568].goal.getItem[2].id) >= qt[2568].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2568].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1016].goal.getItem[1].id) >= qt[1016].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1016].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1017].goal.getItem[1].id) >= qt[1017].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1017].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1018].goal.getItem[1].id) >= qt[1018].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1018].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2566].goal.getItem[1].id) >= qt[2566].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2566].goal.getItem[2].id) >= qt[2566].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2566].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2567].goal.getItem[1].id) >= qt[2567].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2567].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2568].goal.getItem[1].id) >= qt[2568].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2568].goal.getItem[2].id) >= qt[2568].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2568].goal.getItem) then

--- npc_320003.lua
+++ npc_320003_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2473].goal.getItem[1].id) >= qt[2473].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2473].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2475].goal.getItem[1].id) >= qt[2475].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2475].goal.getItem) then

--- npc_320004.lua
+++ npc_320004_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2482].goal.getItem[1].id) >= qt[2482].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2482].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2483].goal.getItem[1].id) >= qt[2483].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2483].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2484].goal.getItem[1].id) >= qt[2484].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2484].goal.getItem) then

--- npc_321001.lua
+++ npc_321001_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[3657].goal.getItem[1].id) >= qt[3657].goal.getItem[1].count and CHECK_ITEM_CNT(qt[3657].goal.getItem[2].id) >= qt[3657].goal.getItem[2].count and CHECK_ITEM_CNT(qt[3657].goal.getItem[3].id) >= qt[3657].goal.getItem[3].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3657].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3657].goal.getItem[1].id) >= qt[3657].goal.getItem[1].count and CHECK_ITEM_CNT(qt[3657].goal.getItem[2].id) >= qt[3657].goal.getItem[2].count and CHECK_ITEM_CNT(qt[3657].goal.getItem[3].id) >= qt[3657].goal.getItem[3].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3657].goal.getItem) then

--- npc_321002.lua
+++ npc_321002_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[3656].goal.getItem[1].id) >= qt[3656].goal.getItem[1].count and CHECK_ITEM_CNT(qt[3656].goal.getItem[2].id) >= qt[3656].goal.getItem[2].count and CHECK_ITEM_CNT(qt[3656].goal.getItem[3].id) >= qt[3656].goal.getItem[3].count and CHECK_ITEM_CNT(qt[3656].goal.getItem[4].id) >= qt[3656].goal.getItem[4].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3656].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3656].goal.getItem[1].id) >= qt[3656].goal.getItem[1].count and CHECK_ITEM_CNT(qt[3656].goal.getItem[2].id) >= qt[3656].goal.getItem[2].count and CHECK_ITEM_CNT(qt[3656].goal.getItem[3].id) >= qt[3656].goal.getItem[3].count and CHECK_ITEM_CNT(qt[3656].goal.getItem[4].id) >= qt[3656].goal.getItem[4].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3656].goal.getItem) then

--- npc_322003.lua
+++ npc_322003_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-   if qData[2331].state == 1 and CHECK_ITEM_CNT(qt[2331].goal.getItem[1].id) >= qt[2331].goal.getItem[1].count then
+   if qData[2331].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[2331].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2677].goal.getItem[1].id) >= qt[2677].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2677].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2331].goal.getItem[1].id) >= qt[2331].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2331].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2677].goal.getItem[1].id) >= qt[2677].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2677].goal.getItem) then
-   if qData[2792].state == 1 and CHECK_ITEM_CNT(qt[2792].goal.getItem[1].id) >= qt[2792].goal.getItem[1].count and qData[2792].killMonster[qt[2792].goal.killMonster[1].id] >= qt[2792].goal.killMonster[1].count then
+   if qData[2792].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[2792].goal.getItem) and qData[2792].killMonster[qt[2792].goal.killMonster[1].id] >= qt[2792].goal.killMonster[1].count then

--- npc_322004.lua
+++ npc_322004_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1058].goal.getItem[1].id) >= qt[1058].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1058].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1059].goal.getItem[1].id) >= qt[1059].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1059].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2712].goal.getItem[1].id) >= qt[2712].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2712].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1058].goal.getItem[1].id) >= qt[1058].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1058].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1059].goal.getItem[1].id) >= qt[1059].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1059].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2712].goal.getItem[1].id) >= qt[2712].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2712].goal.getItem) then

--- npc_322005.lua
+++ npc_322005_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1060].goal.getItem[1].id) >= qt[1060].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1060].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1061].goal.getItem[1].id) >= qt[1061].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1061].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2713].goal.getItem[1].id) >= qt[2713].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2713].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1060].goal.getItem[1].id) >= qt[1060].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1060].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1061].goal.getItem[1].id) >= qt[1061].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1061].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2713].goal.getItem[1].id) >= qt[2713].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2713].goal.getItem) then

--- npc_322006.lua
+++ npc_322006_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2679].goal.getItem[1].id) >= qt[2679].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2679].goal.getItem[2].id) >= qt[2679].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2679].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2799].goal.getItem[1].id) >= qt[2799].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2799].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2679].goal.getItem[1].id) >= qt[2679].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2679].goal.getItem[2].id) >= qt[2679].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2679].goal.getItem) then
-   if qData[2793].state == 1 and CHECK_ITEM_CNT(qt[2793].goal.getItem[1].id) >= qt[2793].goal.getItem[1].count then
+   if qData[2793].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[2793].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2799].goal.getItem[1].id) >= qt[2799].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2799].goal.getItem) then

--- npc_322009.lua
+++ npc_322009_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-   if qData[2330].state == 1 and CHECK_ITEM_CNT(qt[2330].goal.getItem[1].id) >= qt[2330].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2330].goal.getItem[2].id) >= qt[2330].goal.getItem[2].count then
+   if qData[2330].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[2330].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2330].goal.getItem[1].id) >= qt[2330].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2330].goal.getItem[2].id) >= qt[2330].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2330].goal.getItem) then
-   if qData[2791].state == 1 and CHECK_ITEM_CNT(qt[2791].goal.getItem[1].id) >= qt[2791].goal.getItem[1].count and qData[2791].killMonster[qt[2791].goal.killMonster[1].id] >= qt[2791].goal.killMonster[1].count then
+   if qData[2791].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[2791].goal.getItem) and qData[2791].killMonster[qt[2791].goal.killMonster[1].id] >= qt[2791].goal.killMonster[1].count then

--- npc_322012.lua
+++ npc_322012_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-   if qData[2674].state == 1 and CHECK_ITEM_CNT(qt[2674].goal.getItem[1].id) >= qt[2674].goal.getItem[1].count then
+   if qData[2674].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[2674].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2710].goal.getItem[1].id) >= qt[2710].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2710].goal.getItem[2].id) >= qt[2710].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2710].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2711].goal.getItem[1].id) >= qt[2711].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2711].goal.getItem[2].id) >= qt[2711].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2711].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2730].goal.getItem[1].id) >= qt[2730].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2730].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2731].goal.getItem[1].id) >= qt[2731].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2731].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2674].goal.getItem[1].id) >= qt[2674].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2674].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2710].goal.getItem[1].id) >= qt[2710].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2710].goal.getItem[2].id) >= qt[2710].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2710].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2711].goal.getItem[1].id) >= qt[2711].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2711].goal.getItem[2].id) >= qt[2711].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2711].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2730].goal.getItem[1].id) >= qt[2730].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2730].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2731].goal.getItem[1].id) >= qt[2731].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2731].goal.getItem) then

--- npc_322013.lua
+++ npc_322013_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2671].goal.getItem[1].id) >= qt[2671].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2671].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2672].goal.getItem[1].id) >= qt[2672].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2672].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2673].goal.getItem[1].id) >= qt[2673].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2673].goal.getItem[2].id) >= qt[2673].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2673].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2671].goal.getItem[1].id) >= qt[2671].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2671].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2672].goal.getItem[1].id) >= qt[2672].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2672].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2673].goal.getItem[1].id) >= qt[2673].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2673].goal.getItem[2].id) >= qt[2673].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2673].goal.getItem) then

--- npc_322014.lua
+++ npc_322014_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2816].goal.getItem[1].id) >= qt[2816].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2816].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2819].goal.getItem[1].id) >= qt[2819].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2819].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2816].goal.getItem[1].id) >= qt[2816].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2816].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2819].goal.getItem[1].id) >= qt[2819].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2819].goal.getItem) then

--- npc_322015.lua
+++ npc_322015_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2744].goal.getItem[1].id) >= qt[2744].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2744].goal.getItem[2].id) >= qt[2744].goal.getItem[2].count and CHECK_ITEM_CNT(qt[2744].goal.getItem[3].id) >= qt[2744].goal.getItem[3].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2744].goal.getItem) then
-   if qData[2789].state == 1 and CHECK_ITEM_CNT(qt[2789].goal.getItem[1].id) >= qt[2789].goal.getItem[1].count then
+   if qData[2789].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[2789].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2744].goal.getItem[1].id) >= qt[2744].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2744].goal.getItem[2].id) >= qt[2744].goal.getItem[2].count and CHECK_ITEM_CNT(qt[2744].goal.getItem[3].id) >= qt[2744].goal.getItem[3].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2744].goal.getItem) then
-   if qData[2789].state == 1 and CHECK_ITEM_CNT(qt[2789].goal.getItem[1].id) >= qt[2789].goal.getItem[1].count then
+   if qData[2789].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[2789].goal.getItem) then

--- npc_322016.lua
+++ npc_322016_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2833].goal.getItem[1].id) >= qt[2833].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2833].goal.getItem[2].id) >= qt[2833].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2833].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2832].goal.getItem[1].id) >= qt[2832].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2832].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2833].goal.getItem[1].id) >= qt[2833].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2833].goal.getItem[2].id) >= qt[2833].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2833].goal.getItem) then

--- npc_322017.lua
+++ npc_322017_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2788].goal.getItem[1].id) >= qt[2788].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2788].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2861].goal.getItem[1].id) >= qt[2861].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2861].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2788].goal.getItem[1].id) >= qt[2788].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2788].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2861].goal.getItem[1].id) >= qt[2861].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2861].goal.getItem) then

--- npc_322019.lua
+++ npc_322019_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2735].goal.getItem[1].id) >= qt[2735].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2735].goal.getItem) then
-   if qData[2790].state == 1 and CHECK_ITEM_CNT(qt[2790].goal.getItem[1].id) >= qt[2790].goal.getItem[1].count then
+   if qData[2790].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[2790].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2830].goal.getItem[1].id) >= qt[2830].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2830].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2831].goal.getItem[1].id) >= qt[2831].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2831].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2735].goal.getItem[1].id) >= qt[2735].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2735].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2830].goal.getItem[1].id) >= qt[2830].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2830].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2831].goal.getItem[1].id) >= qt[2831].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2831].goal.getItem) then

--- npc_323001.lua
+++ npc_323001_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2600].goal.getItem[1].id) >= qt[2600].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2600].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2600].goal.getItem[1].id) >= qt[2600].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2600].goal.getItem) then

--- npc_323003.lua
+++ npc_323003_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2599].goal.getItem[1].id) >= qt[2599].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2599].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2599].goal.getItem[1].id) >= qt[2599].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2599].goal.getItem) then

--- npc_323004.lua
+++ npc_323004_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2185].goal.getItem[1].id) >= qt[2185].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2185].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[3648].goal.getItem[1].id) >= qt[3648].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3648].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2185].goal.getItem[1].id) >= qt[2185].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2185].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3648].goal.getItem[1].id) >= qt[3648].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3648].goal.getItem) then

--- npc_323005.lua
+++ npc_323005_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2186].goal.getItem[1].id) >= qt[2186].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2186].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2883].goal.getItem[1].id) >= qt[2883].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2883].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[3649].goal.getItem[1].id) >= qt[3649].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3649].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2186].goal.getItem[1].id) >= qt[2186].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2186].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2883].goal.getItem[1].id) >= qt[2883].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2883].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3649].goal.getItem[1].id) >= qt[3649].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3649].goal.getItem) then

--- npc_323006.lua
+++ npc_323006_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1476].goal.getItem[1].id) >= qt[1476].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1476].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1477].goal.getItem[1].id) >= qt[1477].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1477].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2593].goal.getItem[1].id) >= qt[2593].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2593].goal.getItem) then
-   if qData[2880].state == 1 and CHECK_ITEM_CNT(qt[2880].goal.getItem[1].id) >= qt[2880].goal.getItem[1].count then
+   if qData[2880].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[2880].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2888].goal.getItem[1].id) >= qt[2888].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2888].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2889].goal.getItem[1].id) >= qt[2889].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2889].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1476].goal.getItem[1].id) >= qt[1476].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1476].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1477].goal.getItem[1].id) >= qt[1477].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1477].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2593].goal.getItem[1].id) >= qt[2593].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2593].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2880].goal.getItem[1].id) >= qt[2880].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2880].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2888].goal.getItem[1].id) >= qt[2888].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2888].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2889].goal.getItem[1].id) >= qt[2889].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2889].goal.getItem) then

--- npc_323007.lua
+++ npc_323007_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-   if qData[2882].state == 1 and CHECK_ITEM_CNT(qt[2882].goal.getItem[1].id) >= qt[2882].goal.getItem[1].count then
+   if qData[2882].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[2882].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2882].goal.getItem[1].id) >= qt[2882].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2882].goal.getItem) then

--- npc_323009.lua
+++ npc_323009_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1483].goal.getItem[1].id) >= qt[1483].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1483].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[874].goal.getItem[1].id) >= qt[874].goal.getItem[1].count and CHECK_ITEM_CNT(qt[874].goal.getItem[2].id) >= qt[874].goal.getItem[2].count and CHECK_ITEM_CNT(qt[874].goal.getItem[3].id) >= qt[874].goal.getItem[3].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[874].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[875].goal.getItem[1].id) >= qt[875].goal.getItem[1].count and CHECK_ITEM_CNT(qt[875].goal.getItem[2].id) >= qt[875].goal.getItem[2].count and CHECK_ITEM_CNT(qt[875].goal.getItem[3].id) >= qt[875].goal.getItem[3].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[875].goal.getItem) then
-   if qData[2858].state == 1 and CHECK_ITEM_CNT(qt[2858].goal.getItem[1].id) >= qt[2858].goal.getItem[1].count then
+   if qData[2858].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[2858].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2859].goal.getItem[1].id) >= qt[2859].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2859].goal.getItem[2].id) >= qt[2859].goal.getItem[2].count and CHECK_ITEM_CNT(qt[2859].goal.getItem[3].id) >= qt[2859].goal.getItem[3].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2859].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2860].goal.getItem[1].id) >= qt[2860].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2860].goal.getItem) then
-   if qData[2864].state == 1 and CHECK_ITEM_CNT(qt[2864].goal.getItem[1].id) >= qt[2864].goal.getItem[1].count then
+   if qData[2864].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[2864].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1483].goal.getItem[1].id) >= qt[1483].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1483].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[874].goal.getItem[1].id) >= qt[874].goal.getItem[1].count and CHECK_ITEM_CNT(qt[874].goal.getItem[2].id) >= qt[874].goal.getItem[2].count and CHECK_ITEM_CNT(qt[874].goal.getItem[3].id) >= qt[874].goal.getItem[3].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[874].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[875].goal.getItem[1].id) >= qt[875].goal.getItem[1].count and CHECK_ITEM_CNT(qt[875].goal.getItem[2].id) >= qt[875].goal.getItem[2].count and CHECK_ITEM_CNT(qt[875].goal.getItem[3].id) >= qt[875].goal.getItem[3].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[875].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2858].goal.getItem[1].id) >= qt[2858].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2858].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2859].goal.getItem[1].id) >= qt[2859].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2859].goal.getItem[2].id) >= qt[2859].goal.getItem[2].count and CHECK_ITEM_CNT(qt[2859].goal.getItem[3].id) >= qt[2859].goal.getItem[3].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2859].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2860].goal.getItem[1].id) >= qt[2860].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2860].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2864].goal.getItem[1].id) >= qt[2864].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2864].goal.getItem) then

--- npc_323012.lua
+++ npc_323012_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2183].goal.getItem[1].id) >= qt[2183].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2183].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2589].goal.getItem[1].id) >= qt[2589].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2589].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2595].goal.getItem[1].id) >= qt[2595].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2595].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[3646].goal.getItem[1].id) >= qt[3646].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3646].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2183].goal.getItem[1].id) >= qt[2183].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2183].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2589].goal.getItem[1].id) >= qt[2589].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2589].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2595].goal.getItem[1].id) >= qt[2595].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2595].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3646].goal.getItem[1].id) >= qt[3646].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3646].goal.getItem) then

--- npc_323013.lua
+++ npc_323013_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2587].goal.getItem[1].id) >= qt[2587].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2587].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2591].goal.getItem[1].id) >= qt[2591].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2591].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2587].goal.getItem[1].id) >= qt[2587].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2587].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2591].goal.getItem[1].id) >= qt[2591].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2591].goal.getItem) then

--- npc_324003.lua
+++ npc_324003_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1524].goal.getItem[1].id) >= qt[1524].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1524].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[885].goal.getItem[1].id) >= qt[885].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[885].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[1524].goal.getItem[1].id) >= qt[1524].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[1524].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[885].goal.getItem[1].id) >= qt[885].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[885].goal.getItem) then

--- npc_341001.lua
+++ npc_341001_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[3729].goal.getItem[1].id) >= qt[3729].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3729].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[3783].goal.getItem[1].id) >= qt[3783].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3783].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3729].goal.getItem[1].id) >= qt[3729].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3729].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3783].goal.getItem[1].id) >= qt[3783].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3783].goal.getItem) then

--- npc_341004.lua
+++ npc_341004_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2723].goal.getItem[1].id) >= qt[2723].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2723].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2723].goal.getItem[1].id) >= qt[2723].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2723].goal.getItem) then

--- npc_341005.lua
+++ npc_341005_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[3731].goal.getItem[1].id) >= qt[3731].goal.getItem[1].count and CHECK_ITEM_CNT(qt[3731].goal.getItem[2].id) >= qt[3731].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3731].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3731].goal.getItem[1].id) >= qt[3731].goal.getItem[1].count and CHECK_ITEM_CNT(qt[3731].goal.getItem[2].id) >= qt[3731].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3731].goal.getItem) then

--- npc_341007.lua
+++ npc_341007_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2914].goal.getItem[1].id) >= qt[2914].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2914].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2914].goal.getItem[1].id) >= qt[2914].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2914].goal.getItem) then

--- npc_341008.lua
+++ npc_341008_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2912].goal.getItem[1].id) >= qt[2912].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2912].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2912].goal.getItem[1].id) >= qt[2912].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2912].goal.getItem) then

--- npc_341011.lua
+++ npc_341011_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2908].goal.getItem[1].id) >= qt[2908].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2908].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2908].goal.getItem[1].id) >= qt[2908].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2908].goal.getItem) then

--- npc_341013.lua
+++ npc_341013_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[3730].goal.getItem[1].id) >= qt[3730].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3730].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3730].goal.getItem[1].id) >= qt[3730].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3730].goal.getItem) then

--- npc_341014.lua
+++ npc_341014_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[3732].goal.getItem[1].id) >= qt[3732].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3732].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3732].goal.getItem[1].id) >= qt[3732].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3732].goal.getItem) then

--- npc_341019.lua
+++ npc_341019_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if qData[2720].meetNpc[1] == qt[2720].goal.meetNpc[1] and qData[2720].meetNpc[2] ~= id and CHECK_ITEM_CNT(qt[2720].goal.getItem[1].id) >= qt[2720].goal.getItem[1].count then
+     if qData[2720].meetNpc[1] == qt[2720].goal.meetNpc[1] and qData[2720].meetNpc[2] ~= id and __QUEST_HAS_ALL_ITEMS(qt[2720].goal.getItem) then
-       if qData[2720].meetNpc[1] == qt[2720].goal.meetNpc[1] and qData[2720].meetNpc[2] ~= id and CHECK_ITEM_CNT(qt[2720].goal.getItem[1].id) >= qt[2720].goal.getItem[1].count then
+       if qData[2720].meetNpc[1] == qt[2720].goal.meetNpc[1] and qData[2720].meetNpc[2] ~= id and __QUEST_HAS_ALL_ITEMS(qt[2720].goal.getItem) then

--- npc_341020.lua
+++ npc_341020_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if qData[2724].meetNpc[1] == qt[2724].goal.meetNpc[1] and qData[2724].meetNpc[2] ~= id and CHECK_ITEM_CNT(qt[2724].goal.getItem[1].id) >= qt[2724].goal.getItem[1].count then
+     if qData[2724].meetNpc[1] == qt[2724].goal.meetNpc[1] and qData[2724].meetNpc[2] ~= id and __QUEST_HAS_ALL_ITEMS(qt[2724].goal.getItem) then
-       if qData[2724].meetNpc[1] == qt[2724].goal.meetNpc[1] and qData[2724].meetNpc[2] ~= id and CHECK_ITEM_CNT(qt[2724].goal.getItem[1].id) >= qt[2724].goal.getItem[1].count then
+       if qData[2724].meetNpc[1] == qt[2724].goal.meetNpc[1] and qData[2724].meetNpc[2] ~= id and __QUEST_HAS_ALL_ITEMS(qt[2724].goal.getItem) then

--- npc_341021.lua
+++ npc_341021_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2722].goal.getItem[1].id) >= qt[2722].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2722].goal.getItem[2].id) >= qt[2722].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2722].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[3735].goal.getItem[1].id) >= qt[3735].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3735].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[3786].goal.getItem[1].id) >= qt[3786].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3786].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2722].goal.getItem[1].id) >= qt[2722].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2722].goal.getItem[2].id) >= qt[2722].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2722].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3735].goal.getItem[1].id) >= qt[3735].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3735].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3786].goal.getItem[1].id) >= qt[3786].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3786].goal.getItem) then

--- npc_341022.lua
+++ npc_341022_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-   if qData[2906].state == 1 and CHECK_ITEM_CNT(qt[2906].goal.getItem[1].id) >= qt[2906].goal.getItem[1].count then
+   if qData[2906].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[2906].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[3733].goal.getItem[1].id) >= qt[3733].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3733].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[3784].goal.getItem[1].id) >= qt[3784].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[3784].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3733].goal.getItem[1].id) >= qt[3733].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3733].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[3784].goal.getItem[1].id) >= qt[3784].goal.getItem[1].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[3784].goal.getItem) then

--- npc_391001.lua
+++ npc_391001_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[1502].goal.getItem[1].id) >= qt[1502].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1502].goal.getItem) then
-   if qData[3629].state == 1 and CHECK_ITEM_CNT(qt[3629].goal.getItem[1].id) >= qt[3629].goal.getItem[1].count then
+   if qData[3629].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[3629].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1502].goal.getItem[1].id) >= qt[1502].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1502].goal.getItem) then
-   if qData[3629].state == 1 and CHECK_ITEM_CNT(qt[3629].goal.getItem[1].id) >= qt[3629].goal.getItem[1].count then
+   if qData[3629].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[3629].goal.getItem) then

--- npc_391104.lua
+++ npc_391104_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-   if qData[1347].state == 1 and CHECK_ITEM_CNT(qt[1347].goal.getItem[1].id) >= qt[1347].goal.getItem[1].count then
+   if qData[1347].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1347].goal.getItem) then

--- npc_391112.lua
+++ npc_391112_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[2698].goal.getItem[1].id) >= qt[2698].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2698].goal.getItem[2].id) >= qt[2698].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2698].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2699].goal.getItem[1].id) >= qt[2699].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2699].goal.getItem[2].id) >= qt[2699].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2699].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2700].goal.getItem[1].id) >= qt[2700].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2700].goal.getItem[2].id) >= qt[2700].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2700].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[2701].goal.getItem[1].id) >= qt[2701].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2701].goal.getItem[2].id) >= qt[2701].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2701].goal.getItem) then
-   if qData[2736].state == 1 and CHECK_ITEM_CNT(qt[2736].goal.getItem[1].id) >= qt[2736].goal.getItem[1].count and qData[2736].killMonster[qt[2736].goal.killMonster[1].id] >= qt[2736].goal.killMonster[1].count then
+   if qData[2736].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[2736].goal.getItem) and qData[2736].killMonster[qt[2736].goal.killMonster[1].id] >= qt[2736].goal.killMonster[1].count then
-     if CHECK_ITEM_CNT(qt[2737].goal.getItem[1].id) >= qt[2737].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2737].goal.getItem[2].id) >= qt[2737].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[2737].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2698].goal.getItem[1].id) >= qt[2698].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2698].goal.getItem[2].id) >= qt[2698].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2698].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2699].goal.getItem[1].id) >= qt[2699].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2699].goal.getItem[2].id) >= qt[2699].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2699].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2700].goal.getItem[1].id) >= qt[2700].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2700].goal.getItem[2].id) >= qt[2700].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2700].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2701].goal.getItem[1].id) >= qt[2701].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2701].goal.getItem[2].id) >= qt[2701].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2701].goal.getItem) then
-       if CHECK_ITEM_CNT(qt[2737].goal.getItem[1].id) >= qt[2737].goal.getItem[1].count and CHECK_ITEM_CNT(qt[2737].goal.getItem[2].id) >= qt[2737].goal.getItem[2].count then
+       if __QUEST_HAS_ALL_ITEMS(qt[2737].goal.getItem) then

--- npc_901020.lua
+++ npc_901020_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[145].goal.getItem[1].id) >= qt[145].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[145].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[146].goal.getItem[1].id) >= qt[146].goal.getItem[1].count and CHECK_ITEM_CNT(qt[146].goal.getItem[2].id) >= qt[146].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[146].goal.getItem) then

--- npc_901033.lua
+++ npc_901033_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-   if qData[1245].state == 1 and CHECK_ITEM_CNT(qt[1245].goal.getItem[1].id) >= qt[1245].goal.getItem[1].count then
+   if qData[1245].state == 1 and __QUEST_HAS_ALL_ITEMS(qt[1245].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1245].goal.getItem[1].id) >= qt[1245].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1245].goal.getItem) then

--- npc_901034.lua
+++ npc_901034_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     elseif CHECK_ITEM_CNT(qt[111].goal.getItem[1].id) >= qt[111].goal.getItem[1].count then
+     elseif __QUEST_HAS_ALL_ITEMS(qt[111].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[111].goal.getItem[1].id) >= qt[111].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[111].goal.getItem) then

--- npc_915015.lua
+++ npc_915015_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[158].goal.getItem[1].id) >= qt[158].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[158].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[159].goal.getItem[1].id) >= qt[159].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[159].goal.getItem) then

--- npc_915017.lua
+++ npc_915017_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[155].goal.getItem[1].id) >= qt[155].goal.getItem[1].count and CHECK_ITEM_CNT(qt[155].goal.getItem[2].id) >= qt[155].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[155].goal.getItem) then

--- npc_915018.lua
+++ npc_915018_rewritten.lua
+ local function __QUEST_HAS_ALL_ITEMS(goalItems)
+   for i, v in ipairs(goalItems) do
+     if CHECK_ITEM_CNT(v.id) < v.count then
+       return false
+     end
+   end
+   return true
+ end
+ local function __QUEST_FIRST_ITEM_ID(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].id
+ end
+ local function __QUEST_FIRST_ITEM_COUNT(goalItems)
+   if goalItems == nil or goalItems[1] == nil then
+     return 0
+   end
+   return goalItems[1].count
+ end
-     if CHECK_ITEM_CNT(qt[142].goal.getItem[1].id) >= qt[142].goal.getItem[1].count and CHECK_ITEM_CNT(qt[142].goal.getItem[2].id) >= qt[142].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[142].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[162].goal.getItem[1].id) >= qt[162].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[162].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1069].goal.getItem[1].id) >= qt[1069].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1069].goal.getItem[2].id) >= qt[1069].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1069].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[238].goal.getItem[1].id) >= qt[238].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[238].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[142].goal.getItem[1].id) >= qt[142].goal.getItem[1].count and CHECK_ITEM_CNT(qt[142].goal.getItem[2].id) >= qt[142].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[142].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[162].goal.getItem[1].id) >= qt[162].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[162].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[238].goal.getItem[1].id) >= qt[238].goal.getItem[1].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[238].goal.getItem) then
-     if CHECK_ITEM_CNT(qt[1069].goal.getItem[1].id) >= qt[1069].goal.getItem[1].count and CHECK_ITEM_CNT(qt[1069].goal.getItem[2].id) >= qt[1069].goal.getItem[2].count then
+     if __QUEST_HAS_ALL_ITEMS(qt[1069].goal.getItem) then

